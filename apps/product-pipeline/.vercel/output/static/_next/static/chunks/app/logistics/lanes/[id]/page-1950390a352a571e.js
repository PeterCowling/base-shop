(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6312],{601:(e,s,t)=>{Promise.resolve().then(t.bind(t,9500)),Promise.resolve().then(t.bind(t,6423)),Promise.resolve().then(t.bind(t,368)),Promise.resolve().then(t.bind(t,8634)),Promise.resolve().then(t.bind(t,5016)),Promise.resolve().then(t.bind(t,9602)),Promise.resolve().then(t.bind(t,9633)),Promise.resolve().then(t.bind(t,1875)),Promise.resolve().then(t.bind(t,6884)),Promise.resolve().then(t.bind(t,5216)),Promise.resolve().then(t.bind(t,124)),Promise.resolve().then(t.bind(t,4274))},5480:(e,s,t)=>{"use strict";function r(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-GB",t=Number(e)/100;return Number.isFinite(t)?new Intl.NumberFormat(s,{style:"currency",currency:"EUR",maximumFractionDigits:0}).format(t):"-"}function l(e){return null==e||Number.isNaN(e)?"-":new Intl.NumberFormat("en-GB",{maximumFractionDigits:2}).format(e)}function a(e){return null==e||Number.isNaN(e)?"-":new Intl.NumberFormat("en-GB",{style:"percent",maximumFractionDigits:1}).format(e)}t.d(s,{ZV:()=>l,l9:()=>a,vv:()=>r})},9500:(e,s,t)=>{"use strict";t.d(s,{default:()=>y});var r=t(6586),l=t(7826),a=t(8902);let n={laneVersionId:"",kind:"quote",file:null};function i(e){let{versions:s,loading:t,strings:i,onUploaded:o}=e,[d,c]=(0,l.useState)(n),[u,x]=(0,l.useState)(null),[m,p]=(0,l.useState)(!1),b=(0,l.useCallback)(e=>{var s,t;let r=null!=(t=null==(s=e.target.files)?void 0:s[0])?t:null;c(e=>({...e,file:r}))},[]),f=(0,l.useCallback)(async e=>{if(e.preventDefault(),!d.laneVersionId||!d.file)return void x(i.messages.uploadEvidenceError);p(!0),x(null);try{let e=new FormData;e.append("file",d.file),e.append("laneVersionId",d.laneVersionId),e.append("kind",d.kind.trim()||"quote");let s=await fetch("/api/logistics/evidence/upload",{method:"POST",body:e});if(!s.ok){x(i.messages.uploadEvidenceError),p(!1);return}let t=await s.json();if(!t.ok||!t.uri){x(i.messages.uploadEvidenceError),p(!1);return}(await fetch("/api/logistics/lane-versions/".concat(d.laneVersionId,"/evidence"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kind:d.kind.trim()||"quote",uri:t.uri})})).ok?(x(i.messages.uploadEvidenceSuccess),c(n),await o()):x(i.messages.uploadEvidenceError)}catch(e){console.error(e),x(i.messages.uploadEvidenceError)}finally{p(!1)}},[d,o,i.messages]),g=t||m;return(0,r.jsxs)("section",{className:"pp-card p-6",children:[(0,r.jsxs)(a.BJ,{gap:2,children:[(0,r.jsx)("span",{className:"text-xs uppercase tracking-widest text-foreground/60",children:i.evidence.label}),(0,r.jsx)("h2",{className:"text-xl font-semibold tracking-tight",children:i.evidence.title})]}),(0,r.jsxs)("form",{className:"mt-4 grid gap-4 md:grid-cols-2",onSubmit:f,children:[(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60 md:col-span-2",children:[i.fields.evidenceKind,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:d.kind,onChange:e=>c(s=>({...s,kind:e.target.value})),disabled:g,type:"text"})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60 md:col-span-2",children:[i.fields.evidenceFile,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm file:me-3 file:rounded-full file:border-0 file:bg-primary/10 file:px-3 file:py-2 file:text-xs file:font-semibold file:text-primary",onChange:b,disabled:g,type:"file"})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60 md:col-span-2",children:[i.fields.versionLabel,(0,r.jsxs)("select",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:d.laneVersionId,onChange:e=>c(s=>({...s,laneVersionId:e.target.value})),disabled:g,children:[(0,r.jsx)("option",{value:"",children:i.placeholders.selectVersion}),s.map(e=>{var s,t,l;return(0,r.jsx)("option",{value:e.id,children:null!=(l=e.versionLabel)?l:"".concat(null!=(s=e.confidence)?s:""," ").concat(null!=(t=e.createdAt)?t:"").trim()},e.id)})]})]}),(0,r.jsxs)(a.d2,{justify:"between",alignY:"center",className:"gap-3 md:col-span-2",children:[(0,r.jsx)("span",{className:"text-xs text-foreground/60",children:null!=u?u:i.notAvailable}),(0,r.jsx)("button",{className:"min-h-12 min-w-12 rounded-full bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground disabled:cursor-not-allowed disabled:opacity-60",type:"submit",disabled:g,children:i.evidence.action})]})]})]})}let o={laneVersionId:"",actualCostAmount:"",actualLeadTimeDays:"",source:"",notes:"",promoteConfidence:!1};function d(e){let{versions:s,loading:t,strings:n,onCreated:i}=e,[d,c]=(0,l.useState)(o),[u,x]=(0,l.useState)(null),[m,p]=(0,l.useState)(!1),b=(0,l.useCallback)(async e=>{if(e.preventDefault(),!d.laneVersionId)return void x(n.messages.createActualsError);let s=function(e){let s=e.trim();if(!s)return;let t=Number.parseFloat(s);return!Number.isFinite(t)||t<0?null:t}(d.actualCostAmount),t=function(e){let s=e.trim();if(!s)return;let t=Number.parseInt(s,10);return!Number.isFinite(t)||t<0?null:t}(d.actualLeadTimeDays);if(null===s||null===t||void 0===s&&void 0===t)return void x(n.messages.createActualsError);let r={...void 0!==s?{actualCostAmount:s}:{},...void 0!==t?{actualLeadTimeDays:t}:{},...d.source.trim()?{source:d.source.trim()}:{},...d.notes.trim()?{notes:d.notes.trim()}:{},promoteConfidence:d.promoteConfidence};p(!0),x(null);try{let e=await fetch("/api/logistics/lane-versions/".concat(d.laneVersionId,"/actuals"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),s=await e.json().catch(()=>null);e.ok&&(null==s?void 0:s.ok)?(x(n.messages.createActualsSuccess),c(o),await i()):x(n.messages.createActualsError)}catch(e){console.error(e),x(n.messages.createActualsError)}finally{p(!1)}},[d,i,n.messages]),f=t||m;return(0,r.jsxs)("section",{className:"pp-card p-6",children:[(0,r.jsxs)(a.BJ,{gap:2,children:[(0,r.jsx)("span",{className:"text-xs uppercase tracking-widest text-foreground/60",children:n.actuals.label}),(0,r.jsx)("h2",{className:"text-xl font-semibold tracking-tight",children:n.actuals.title})]}),(0,r.jsxs)("form",{className:"mt-4 grid gap-4 md:grid-cols-2",onSubmit:b,children:[(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60 md:col-span-2",children:[n.fields.versionLabel,(0,r.jsxs)("select",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:d.laneVersionId,onChange:e=>c(s=>({...s,laneVersionId:e.target.value})),disabled:f,children:[(0,r.jsx)("option",{value:"",children:n.placeholders.selectVersion}),s.map(e=>{var s,t,l;return(0,r.jsx)("option",{value:e.id,children:null!=(l=e.versionLabel)?l:"".concat(null!=(s=e.confidence)?s:""," ").concat(null!=(t=e.createdAt)?t:"").trim()},e.id)})]})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.actualCostAmount,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:d.actualCostAmount,onChange:e=>c(s=>({...s,actualCostAmount:e.target.value})),disabled:f,type:"number",min:0,step:"0.01",placeholder:n.placeholders.optional})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.actualLeadTimeDays,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:d.actualLeadTimeDays,onChange:e=>c(s=>({...s,actualLeadTimeDays:e.target.value})),disabled:f,type:"number",min:0,step:"1",placeholder:n.placeholders.optional})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.actualsSource,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:d.source,onChange:e=>c(s=>({...s,source:e.target.value})),disabled:f,type:"text",placeholder:n.placeholders.optional})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.actualsNotes,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:d.notes,onChange:e=>c(s=>({...s,notes:e.target.value})),disabled:f,type:"text",placeholder:n.placeholders.optional})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-xs uppercase tracking-widest text-foreground/60 md:col-span-2",children:[(0,r.jsx)("input",{className:"h-4 w-4 min-h-12 min-w-12 shrink-0 rounded border border-border-2",checked:d.promoteConfidence,onChange:e=>c(s=>({...s,promoteConfidence:e.target.checked})),disabled:f,type:"checkbox"}),n.actuals.promoteLabel]}),(0,r.jsx)("div",{className:"text-xs text-foreground/60 md:col-span-2",children:n.actuals.promoteHelp}),(0,r.jsxs)(a.d2,{justify:"between",alignY:"center",className:"gap-3 md:col-span-2",children:[(0,r.jsx)("span",{className:"text-xs text-foreground/60",children:null!=u?u:n.notAvailable}),(0,r.jsx)("button",{className:"min-h-12 min-w-12 rounded-full bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground disabled:cursor-not-allowed disabled:opacity-60",type:"submit",disabled:f,children:n.actuals.action})]})]})]})}let c={versionLabel:"",status:"active",confidence:"C0",expiresAt:"",currency:"EUR",sourceCurrency:"",fxRate:"",fxDate:"",fxSource:"",leadTimeLow:"",leadTimeBase:"",leadTimeHigh:"",costBasis:"",costAmount:"",costMinimum:"",includedNotes:"",excludedNotes:"",notes:""};function u(e){let s=Number.parseFloat(e);return Number.isFinite(s)?s:void 0}function x(e){let s=Number.parseInt(e,10);return Number.isFinite(s)?s:void 0}function m(e){let{laneId:s,loading:t,strings:n,onCreated:i}=e,[o,d]=(0,l.useState)(c),[m,p]=(0,l.useState)(null),[b,f]=(0,l.useState)(!1),g=(0,l.useCallback)(async e=>{if(e.preventDefault(),!o.currency.trim())return void p(n.messages.createVersionError);let t={versionLabel:o.versionLabel.trim()||void 0,status:o.status.trim()||void 0,confidence:o.confidence.trim()||void 0,expiresAt:o.expiresAt.trim()||void 0,currency:o.currency.trim(),sourceCurrency:o.sourceCurrency.trim()||void 0,fxRate:u(o.fxRate),fxDate:o.fxDate.trim()||void 0,fxSource:o.fxSource.trim()||void 0,leadTimeLowDays:x(o.leadTimeLow),leadTimeBaseDays:x(o.leadTimeBase),leadTimeHighDays:x(o.leadTimeHigh),costBasis:o.costBasis.trim()||void 0,costAmount:u(o.costAmount),costMinimum:u(o.costMinimum),includedNotes:o.includedNotes.trim()||void 0,excludedNotes:o.excludedNotes.trim()||void 0,notes:o.notes.trim()||void 0};f(!0),p(null);try{(await fetch("/api/logistics/lanes/".concat(s,"/versions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?(p(n.messages.createVersionSuccess),d(c),await i()):p(n.messages.createVersionError)}catch(e){console.error(e),p(n.messages.createVersionError)}finally{f(!1)}},[o,s,i,n.messages]),h=t||b;return(0,r.jsxs)("section",{className:"pp-card p-6",children:[(0,r.jsxs)(a.BJ,{gap:2,children:[(0,r.jsx)("span",{className:"text-xs uppercase tracking-widest text-foreground/60",children:n.version.label}),(0,r.jsx)("h2",{className:"text-xl font-semibold tracking-tight",children:n.version.title})]}),(0,r.jsxs)("form",{className:"mt-4 grid gap-4 md:grid-cols-2",onSubmit:g,children:[(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.versionLabel,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.versionLabel,onChange:e=>d(s=>({...s,versionLabel:e.target.value})),disabled:h,type:"text",placeholder:n.placeholders.optional})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.status,(0,r.jsxs)("select",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.status,onChange:e=>d(s=>({...s,status:e.target.value})),disabled:h,children:[(0,r.jsx)("option",{value:"active",children:"active"}),(0,r.jsx)("option",{value:"draft",children:"draft"}),(0,r.jsx)("option",{value:"superseded",children:"superseded"}),(0,r.jsx)("option",{value:"expired",children:"expired"})]})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.confidence,(0,r.jsxs)("select",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.confidence,onChange:e=>d(s=>({...s,confidence:e.target.value})),disabled:h,children:[(0,r.jsx)("option",{value:"C0",children:"C0"}),(0,r.jsx)("option",{value:"C1",children:"C1"}),(0,r.jsx)("option",{value:"C2",children:"C2"}),(0,r.jsx)("option",{value:"C3",children:"C3"})]})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.expiresAt,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.expiresAt,onChange:e=>d(s=>({...s,expiresAt:e.target.value})),disabled:h,type:"date"})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.currency,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.currency,onChange:e=>d(s=>({...s,currency:e.target.value})),disabled:h,type:"text"})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.sourceCurrency,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.sourceCurrency,onChange:e=>d(s=>({...s,sourceCurrency:e.target.value})),disabled:h,type:"text",placeholder:n.placeholders.optional})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.fxRate,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.fxRate,onChange:e=>d(s=>({...s,fxRate:e.target.value})),disabled:h,type:"number",step:"0.0001",min:0})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.fxDate,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.fxDate,onChange:e=>d(s=>({...s,fxDate:e.target.value})),disabled:h,type:"date"})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.fxSource,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.fxSource,onChange:e=>d(s=>({...s,fxSource:e.target.value})),disabled:h,type:"text",placeholder:n.placeholders.optional})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.leadTimeLow,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.leadTimeLow,onChange:e=>d(s=>({...s,leadTimeLow:e.target.value})),disabled:h,type:"number",min:0})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.leadTimeBase,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.leadTimeBase,onChange:e=>d(s=>({...s,leadTimeBase:e.target.value})),disabled:h,type:"number",min:0})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.leadTimeHigh,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.leadTimeHigh,onChange:e=>d(s=>({...s,leadTimeHigh:e.target.value})),disabled:h,type:"number",min:0})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.costBasis,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.costBasis,onChange:e=>d(s=>({...s,costBasis:e.target.value})),disabled:h,type:"text"})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.costAmount,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.costAmount,onChange:e=>d(s=>({...s,costAmount:e.target.value})),disabled:h,type:"number",step:"0.01",min:0})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[n.fields.costMinimum,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.costMinimum,onChange:e=>d(s=>({...s,costMinimum:e.target.value})),disabled:h,type:"number",step:"0.01",min:0})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60 md:col-span-2",children:[n.fields.includedNotes,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.includedNotes,onChange:e=>d(s=>({...s,includedNotes:e.target.value})),disabled:h,type:"text",placeholder:n.placeholders.optional})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60 md:col-span-2",children:[n.fields.excludedNotes,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.excludedNotes,onChange:e=>d(s=>({...s,excludedNotes:e.target.value})),disabled:h,type:"text",placeholder:n.placeholders.optional})]}),(0,r.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60 md:col-span-2",children:[n.fields.notes,(0,r.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:o.notes,onChange:e=>d(s=>({...s,notes:e.target.value})),disabled:h,type:"text",placeholder:n.placeholders.optional})]}),(0,r.jsxs)(a.d2,{justify:"between",alignY:"center",className:"gap-3 md:col-span-2",children:[(0,r.jsx)("span",{className:"text-xs text-foreground/60",children:null!=m?m:n.notAvailable}),(0,r.jsx)("button",{className:"min-h-12 min-w-12 rounded-full bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground disabled:cursor-not-allowed disabled:opacity-60",type:"submit",disabled:h,children:n.version.action})]})]})]})}var p=t(5480);let b=[{key:"costAmount",labelKey:"costAmount"},{key:"costBasis",labelKey:"costBasis"},{key:"leadTimeBaseDays",labelKey:"leadTimeBase"},{key:"confidence",labelKey:"confidence"},{key:"expiresAt",labelKey:"expiresAt"},{key:"currency",labelKey:"currency"}];function f(e,s){return null==e||""===e?s.notAvailable:"number"==typeof e?Number.isInteger(e)?String(e):e.toFixed(2):String(e)}function g(e,s){return null==e?s.notAvailable:(0,p.ZV)(e)}function h(e,s){return null==e?s.notAvailable:(0,p.l9)(e)}function v(e){let{versions:s,strings:t}=e,[n,i]=(0,l.useState)({}),[o,d]=(0,l.useState)({}),[c,u]=(0,l.useState)({}),x=(0,l.useCallback)(async e=>{let s=!n[e];if(i(t=>({...t,[e]:s})),s&&!o[e]){u(s=>({...s,[e]:!0}));try{let s=await fetch("/api/logistics/lane-versions/".concat(e));if(!s.ok)return;let t=await s.json();t.ok&&Array.isArray(t.evidence)&&d(s=>({...s,[e]:t.evidence}))}catch(e){console.error(e)}finally{u(s=>({...s,[e]:!1}))}}},[n,o]),m=(0,l.useMemo)(()=>s.map((e,r)=>{var l;return function(e,s,t){if(!s)return[];let r=[];for(let l of b){let a=f(e[l.key],t),n=f(s[l.key],t);a!==n&&r.push("".concat(t.fields[l.labelKey],": ").concat(n," -> ").concat(a))}return r.slice(0,3)}(e,null!=(l=s[r+1])?l:null,t)}),[t,s]);return(0,r.jsxs)("section",{className:"pp-card p-6",children:[(0,r.jsxs)(a.BJ,{gap:2,children:[(0,r.jsx)("span",{className:"text-xs uppercase tracking-widest text-foreground/60",children:t.detail.label}),(0,r.jsx)("h2",{className:"text-xl font-semibold tracking-tight",children:t.detail.title})]}),(0,r.jsx)(a.BJ,{gap:4,className:"mt-6",children:0===s.length?(0,r.jsx)("div",{className:"rounded-2xl border border-border-1 bg-surface-2 p-4 text-sm text-foreground/60",children:t.labels.noVersions}):s.map((e,s)=>{var l,i,d,u,p,b,f,v,y,j,N;let w=function(e,s){if(!e)return{label:s.badges.noExpiry,tone:"text-foreground/60"};let t=new Date(e);if(Number.isNaN(t.getTime()))return null;let r=Math.ceil((t.getTime()-Date.now())/864e5);return r<0?{label:s.badges.expired,tone:"text-red-600"}:r<=14?{label:"".concat(s.badges.expiring," ").concat(r,"d"),tone:"text-amber-600"}:{label:"".concat(s.badges.valid," ").concat(r,"d"),tone:"text-emerald-600"}}(e.expiresAt,t),k=null!=(l=m[s])?l:[],C=null!=(i=o[e.id])?i:[],A=c[e.id],T=function(e){if("C3"===e.confidence||e.actualsCount<2)return!1;let s=[e.actualCostVariancePct,e.actualLeadTimeVariancePct].filter(e=>null!=e).map(e=>.1>=Math.abs(e));return 0!==s.length&&s.every(Boolean)}(e);return(0,r.jsxs)("div",{className:"rounded-3xl border border-border-1 bg-surface-2 p-4",children:[(0,r.jsxs)(a.d2,{justify:"between",alignY:"center",className:"gap-4",children:[(0,r.jsxs)(a.BJ,{gap:1,children:[(0,r.jsx)("span",{className:"text-xs text-foreground/60",children:null!=(d=e.versionLabel)?d:t.placeholders.optional}),(0,r.jsxs)("span",{className:"text-lg font-semibold",children:[null!=(u=e.confidence)?u:t.notAvailable," /"," ",null!=(p=e.currency)?p:t.notAvailable]}),(0,r.jsxs)("span",{className:"text-xs text-foreground/60",children:[t.fields.costBasis,": ",null!=(b=e.costBasis)?b:t.notAvailable," /"," ",t.fields.costAmount,":"," ",null===e.costAmount||void 0===e.costAmount?t.notAvailable:e.costAmount.toFixed(2)]})]}),(0,r.jsxs)(a.BJ,{gap:2,className:"items-end text-xs",children:[(0,r.jsx)("span",{className:"rounded-full border border-border-2 px-3 py-1",children:null!=(f=e.status)?f:t.notAvailable}),w?(0,r.jsx)("span",{className:"text-xs ".concat(w.tone),children:w.label}):null]})]}),(0,r.jsxs)(a.cV,{gap:3,className:"mt-4 text-xs text-foreground/70",children:[(0,r.jsxs)("span",{children:[t.fields.leadTimeBase,":"," ",null!=(v=e.leadTimeBaseDays)?v:t.notAvailable,"d"]}),(0,r.jsxs)("span",{children:[t.fields.leadTimeLow,":"," ",null!=(y=e.leadTimeLowDays)?y:t.notAvailable,"d"]}),(0,r.jsxs)("span",{children:[t.fields.leadTimeHigh,":"," ",null!=(j=e.leadTimeHighDays)?j:t.notAvailable,"d"]})]}),(0,r.jsxs)("div",{className:"mt-3 text-xs text-foreground/60",children:[e.actualsCount>0?(0,r.jsxs)(a.cV,{gap:3,className:"flex-wrap",children:[(0,r.jsx)("span",{children:t.labels.actualsCount.replace("{count}",String(e.actualsCount))}),(0,r.jsxs)("span",{children:[t.labels.actualsAvgCost,":"," ",g(e.actualCostAvg,t)]}),(0,r.jsxs)("span",{children:[t.labels.actualsAvgLeadTime,":"," ",g(e.actualLeadTimeAvg,t),"d"]}),(0,r.jsxs)("span",{children:[t.labels.actualsVarianceCost,":"," ",h(e.actualCostVariancePct,t)]}),(0,r.jsxs)("span",{children:[t.labels.actualsVarianceLeadTime,":"," ",h(e.actualLeadTimeVariancePct,t)]}),(0,r.jsxs)("span",{children:[t.labels.actualsLatest,":"," ",null!=(N=e.actualsLatestAt)?N:t.notAvailable]})]}):(0,r.jsx)("span",{children:t.labels.noActuals}),T?(0,r.jsx)("div",{className:"mt-2 text-emerald-600",children:t.labels.eligibleForC3}):null]}),k.length>0?(0,r.jsxs)("div",{className:"mt-3 text-xs text-foreground/60",children:[(0,r.jsxs)("span",{className:"font-semibold",children:[t.labels.versionDiff,":"]})," ",k.join(" | ")]}):null,(0,r.jsx)("div",{className:"mt-4 text-xs text-foreground/60",children:t.labels.evidenceCount.replace("{count}",String(e.evidenceCount))}),(0,r.jsx)("button",{className:"mt-3 inline-flex min-h-12 min-w-12 items-center justify-center rounded-full border border-border-2 px-4 py-2 text-xs font-semibold",onClick:()=>void x(e.id),type:"button",children:n[e.id]?t.labels.hideEvidence:t.labels.viewEvidence}),n[e.id]?(0,r.jsx)("div",{className:"mt-4 rounded-2xl border border-border-1 bg-surface-1/80 p-4 text-xs",children:A||0===C.length?(0,r.jsx)("div",{className:"text-foreground/60",children:t.notAvailable}):(0,r.jsx)(a.BJ,{gap:2,children:C.map(e=>{var s;return(0,r.jsxs)(a.d2,{justify:"between",alignY:"center",className:"gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-semibold",children:e.kind})," ","/"," ",(0,r.jsx)("span",{className:"text-foreground/60",children:null!=(s=e.createdAt)?s:t.notAvailable})]}),(0,r.jsx)("a",{className:"inline-flex min-h-12 min-w-12 items-center justify-center rounded-full border border-border-2 px-3 py-1 text-xs font-semibold",href:function(e){let s="r2://product-pipeline-evidence/";if(e.startsWith(s)){let t=e.slice(s.length);return"/api/artifacts/download?key=".concat(encodeURIComponent(t))}return e}(e.uri),target:"_blank",rel:"noreferrer",children:t.labels.openDocument})]},e.id)})})}):null]},e.id)})})]})}function y(e){var s,t,n,o,c,u,x;let{laneId:p,strings:b}=e,[f,g]=(0,l.useState)(null),[h,y]=(0,l.useState)([]),[j,N]=(0,l.useState)(!0),w=(0,l.useCallback)(async()=>{N(!0);try{let s=await fetch("/api/logistics/lanes/".concat(p,"?limit=50"));if(!s.ok)return;let t=await s.json();if(t.ok&&t.lane){var e;g(t.lane),y(null!=(e=t.versions)?e:[])}}catch(e){console.error(e)}finally{N(!1)}},[p]);return(0,l.useEffect)(()=>{w()},[w]),(0,r.jsxs)(a.BJ,{gap:6,children:[(0,r.jsxs)("section",{className:"pp-card p-6",children:[(0,r.jsxs)(a.d2,{justify:"between",alignY:"center",className:"gap-4",children:[(0,r.jsxs)(a.BJ,{gap:1,children:[(0,r.jsx)("span",{className:"text-xs uppercase tracking-widest text-foreground/60",children:b.detail.label}),(0,r.jsx)("h2",{className:"text-xl font-semibold tracking-tight",children:null!=(s=null==f?void 0:f.name)?s:b.notAvailable}),(0,r.jsxs)("span",{className:"text-xs text-foreground/60",children:[b.fields.model,": ",null!=(t=null==f?void 0:f.model)?t:b.notAvailable," /"," ",b.fields.incoterm,": ",null!=(n=null==f?void 0:f.incoterm)?n:b.notAvailable]})]}),(0,r.jsx)("span",{className:"rounded-full border border-border-2 px-3 py-1 text-xs",children:f?f.active?b.badges.active:b.badges.inactive:b.notAvailable})]}),(0,r.jsxs)("div",{className:"mt-4 grid gap-3 text-xs text-foreground/60 md:grid-cols-2",children:[(0,r.jsxs)("div",{children:[b.fields.origin,": ",null!=(o=null==f?void 0:f.origin)?o:b.notAvailable]}),(0,r.jsxs)("div",{children:[b.fields.destination,": ",null!=(c=null==f?void 0:f.destination)?c:b.notAvailable]}),(0,r.jsxs)("div",{children:[b.fields.destinationType,":"," ",null!=(u=null==f?void 0:f.destinationType)?u:b.notAvailable]}),(0,r.jsxs)("div",{children:[b.fields.description,": ",null!=(x=null==f?void 0:f.description)?x:b.notAvailable]})]})]}),(0,r.jsx)(m,{laneId:p,loading:j,strings:b,onCreated:w}),(0,r.jsx)(i,{versions:h,loading:j,strings:b,onUploaded:w}),(0,r.jsx)(d,{versions:h,loading:j,strings:b,onCreated:w}),(0,r.jsx)(v,{versions:h,strings:b})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[2827,9683,7106,4668,8902,9956,2459,7358],()=>s(601)),_N_E=e.O()}]);