"use strict";(self.webpackChunkcms_monorepo=self.webpackChunkcms_monorepo||[]).push([[189],{"./packages/ui/src/components/cms/page-builder/LinkPicker.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Basic:()=>Basic,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/next@15.3.5_@babel+core@7.28.4_@opentelemetry+api@1.9.0_@playwright+test@1.53.2_react-d_b38198e836dabfde367dfef63fafdf09/node_modules/next/dist/compiled/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/next@15.3.5_@babel+core@7.28.4_@opentelemetry+api@1.9.0_@playwright+test@1.53.2_react-d_b38198e836dabfde367dfef63fafdf09/node_modules/next/dist/compiled/react/index.js"),_LinkPicker__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/ui/src/components/cms/page-builder/LinkPicker.tsx");const __WEBPACK_DEFAULT_EXPORT__={title:"CMS/Page Builder/LinkPicker",component:_LinkPicker__WEBPACK_IMPORTED_MODULE_2__.A,parameters:{docs:{description:{component:"Picker dialog to link to CMS pages or products; story stubs API responses for demo."}}}};function BasicStory(){const[open,setOpen]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!0);return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{const orig=window.fetch.bind(window);return window.fetch=async(input,init)=>{const u=String(input);return u.includes("/cms/api/pages/")?new Response(JSON.stringify([{id:"p1",slug:"home",seo:{title:{en:"Home"}}},{id:"p2",slug:"about",seo:{title:{en:"About"}}}]),{status:200,headers:{"Content-Type":"application/json"}}):u.includes("/cms/api/products")?new Response(JSON.stringify([{slug:"blue-shirt",title:"Blue Shirt"},{slug:"sneakers",title:"Sneakers"}]),{status:200,headers:{"Content-Type":"application/json"}}):orig(input,init)},()=>{window.fetch=orig}},[]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_LinkPicker__WEBPACK_IMPORTED_MODULE_2__.A,{open,onClose:()=>setOpen(!1),onPick:href=>{alert(`Picked: ${href}`),setOpen(!1)},shop:"bcd"})}const Basic={render:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(BasicStory,{})},__namedExportsOrder=["Basic"];Basic.parameters={...Basic.parameters,docs:{...Basic.parameters?.docs,source:{originalSource:"{\n  render: () => <BasicStory />\n}",...Basic.parameters?.docs?.source}}}},"./packages/ui/src/components/cms/page-builder/LinkPicker.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>LinkPicker});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/next@15.3.5_@babel+core@7.28.4_@opentelemetry+api@1.9.0_@playwright+test@1.53.2_react-d_b38198e836dabfde367dfef63fafdf09/node_modules/next/dist/compiled/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/next@15.3.5_@babel+core@7.28.4_@opentelemetry+api@1.9.0_@playwright+test@1.53.2_react-d_b38198e836dabfde367dfef63fafdf09/node_modules/next/dist/compiled/react/index.js"),_atoms_shadcn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/ui/src/components/atoms/shadcn/index.ts"),_acme_i18n__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/i18n/src/index.ts");function LinkPicker({open,onClose,onPick,shop}){const t=(0,_acme_i18n__WEBPACK_IMPORTED_MODULE_3__.c3)(),[query,setQuery]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(""),[pages,setPages]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),[products,setProducts]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),shopId=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>{var _ref;return null!==(_ref=null!=shop?shop:function deriveShopFromPath(){try{const parts=window.location.pathname.split("/").filter(Boolean),i=parts.findIndex(p=>"shop"===p);if(i>=0&&parts[i+1])return parts[i+1]}catch(e){}}())&&void 0!==_ref?_ref:"bcd"},[shop]);return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{open&&(async()=>{try{const res=await fetch(`/cms/api/pages/${shopId}`);res.ok&&setPages(await res.json())}catch(e){setPages([])}})()},[open,shopId]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{if(!open)return;const controller=new AbortController,t=setTimeout(async()=>{try{const url=new URL("/cms/api/products",window.location.origin);url.searchParams.set("shop",shopId),query&&url.searchParams.set("q",query);const res=await fetch(url.toString(),{signal:controller.signal});res.ok&&setProducts(await res.json())}catch(e){setProducts([])}},200);return()=>{controller.abort(),clearTimeout(t)}},[open,query,shopId]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_2__.lG,{open,onOpenChange:o=>o?void 0:onClose(),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_2__.Cf,{className:"w-full",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_2__.c7,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_2__.L3,{children:t("cms.links.picker.title")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_2__.rr,{children:t("cms.links.picker.description")})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_2__.pd,{value:query,onChange:e=>setQuery(e.target.value),placeholder:t("cms.links.picker.search.placeholder")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mb-1 text-xs font-semibold uppercase text-muted-foreground",children:"Pages"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("ul",{className:"max-h-40 overflow-auto rounded border",children:[pages.map(p=>{var _p_seo_title,_p_seo,_p_seo_title_en;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:"flex items-center justify-between border-b px-2 py-1 last:border-none",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"text-sm",children:null!==(_p_seo_title_en=null===(_p_seo=p.seo)||void 0===_p_seo||null===(_p_seo_title=_p_seo.title)||void 0===_p_seo_title?void 0:_p_seo_title.en)&&void 0!==_p_seo_title_en?_p_seo_title_en:p.slug}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"text-xs text-muted-foreground",children:["/",p.slug]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_2__.$n,{type:"button",className:"h-8 px-2 py-1 text-xs",onClick:()=>onPick(`/${p.slug}`),children:"Select"})]},p.id)}),0===pages.length&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"px-2 py-1 text-sm text-muted-foreground",children:"No pages"})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mb-1 text-xs font-semibold uppercase text-muted-foreground",children:"Products"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("ul",{className:"max-h-40 overflow-auto rounded border",children:[products.map(prod=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:"flex items-center justify-between border-b px-2 py-1 last:border-none",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"text-sm",children:prod.title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"text-xs text-muted-foreground",children:["/products/",prod.slug]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_2__.$n,{type:"button",className:"h-8 px-2 py-1 text-xs",onClick:()=>onPick(`/products/${prod.slug}`),children:"Select"})]},prod.slug)),0===products.length&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"px-2 py-1 text-sm text-muted-foreground",children:"No products"})]})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_2__.Es,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_2__.$n,{type:"button",variant:"outline",onClick:onClose,children:"Close"})})]})})}LinkPicker.__docgenInfo={description:"",methods:[],displayName:"LinkPicker",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onPick:{required:!0,tsType:{name:"signature",type:"function",raw:"(href: string) => void",signature:{arguments:[{type:{name:"string"},name:"href"}],return:{name:"void"}}},description:""},shop:{required:!1,tsType:{name:"string"},description:""}}}}}]);