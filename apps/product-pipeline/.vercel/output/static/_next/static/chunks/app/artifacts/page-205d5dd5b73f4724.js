(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6486],{7467:(e,t,a)=>{"use strict";a.d(t,{default:()=>u});var s=a(6586),l=a(7826),r=a(8902);function n(e){let{strings:t,onUploaded:a}=e,[n,i]=(0,l.useState)([]),[d,o]=(0,l.useState)([]),[c,u]=(0,l.useState)(!0),[x,f]=(0,l.useState)(!1),[m,b]=(0,l.useState)(!1),[p,g]=(0,l.useState)(null),[h,v]=(0,l.useState)({candidateId:"",stageRunId:"",kind:"",file:null}),j=(0,l.useCallback)(async()=>{u(!0);try{let e=await fetch("/api/candidates?limit=200");if(!e.ok)return;let t=await e.json();t.ok&&Array.isArray(t.candidates)&&i(t.candidates.map(e=>({id:e.id,label:function(e){var t;if(null==(t=e.lead)?void 0:t.title){let t=e.id.slice(0,8);return"".concat(e.lead.title," | ").concat(t)}return e.id}(e)})))}catch(e){console.error(e)}finally{u(!1)}},[]),y=(0,l.useCallback)(async e=>{f(!0);try{let t=await fetch("/api/candidates/".concat(e));if(!t.ok)return;let a=await t.json();a.ok&&Array.isArray(a.stageRuns)?o(a.stageRuns.map(e=>({id:e.id,label:function(e){var t;let a=null!=(t=e.createdAt)?t:"";return"".concat(e.stage," | ").concat(e.status).concat(a?" | ".concat(a):"")}(e)}))):o([])}catch(e){console.error(e),o([])}finally{f(!1)}},[]);(0,l.useEffect)(()=>{j()},[j]),(0,l.useEffect)(()=>{if(!h.candidateId)return void o([]);y(h.candidateId)},[h.candidateId,y]);let N=(0,l.useCallback)(async e=>{if(e.preventDefault(),!h.candidateId||!h.stageRunId||!h.kind||!h.file)return void g(t.upload.errorMessage);b(!0),g(null);let s=new FormData;s.set("candidateId",h.candidateId),s.set("stageRunId",h.stageRunId),s.set("kind",h.kind),s.set("file",h.file);try{(await fetch("/api/artifacts/upload",{method:"POST",body:s})).ok?(g(t.upload.successMessage),v({candidateId:"",stageRunId:"",kind:"",file:null}),o([]),await a()):g(t.upload.errorMessage)}catch(e){console.error(e),g(t.upload.errorMessage)}finally{b(!1)}},[h,a,t.upload]),k=m||c,w=k||!h.candidateId||x||0===d.length;return(0,s.jsxs)("section",{className:"pp-card p-6",children:[(0,s.jsxs)(r.BJ,{gap:2,children:[(0,s.jsx)("span",{className:"text-xs uppercase tracking-widest text-foreground/60",children:t.upload.label}),(0,s.jsx)("h2",{className:"text-xl font-semibold tracking-tight",children:t.upload.title})]}),(0,s.jsxs)("form",{className:"mt-4 grid gap-4 md:grid-cols-2",onSubmit:N,children:[(0,s.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[t.upload.candidateLabel,(0,s.jsxs)("select",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:h.candidateId,onChange:e=>v(t=>({...t,candidateId:e.target.value,stageRunId:""})),disabled:k,children:[(0,s.jsx)("option",{value:"",children:c?t.upload.loadingCandidates:t.notAvailable}),n.map(e=>(0,s.jsx)("option",{value:e.id,children:e.label},e.id))]})]}),(0,s.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[t.upload.stageRunLabel,(0,s.jsxs)("select",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:h.stageRunId,onChange:e=>v(t=>({...t,stageRunId:e.target.value})),disabled:w,children:[(0,s.jsx)("option",{value:"",children:x?t.upload.loadingRuns:0===d.length?t.upload.emptyRuns:t.notAvailable}),d.map(e=>(0,s.jsx)("option",{value:e.id,children:e.label},e.id))]})]}),(0,s.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[t.upload.kindLabel,(0,s.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:h.kind,onChange:e=>v(t=>({...t,kind:e.target.value})),disabled:k,type:"text"})]}),(0,s.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[t.upload.fileLabel,(0,s.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",onChange:e=>v(t=>{var a,s;return{...t,file:null!=(s=null==(a=e.target.files)?void 0:a[0])?s:null}}),disabled:k,type:"file"})]}),(0,s.jsxs)(r.d2,{justify:"between",alignY:"center",className:"gap-3 md:col-span-2",children:[(0,s.jsx)("span",{className:"text-xs text-foreground/60",children:null!=p?p:t.notAvailable}),(0,s.jsx)("button",{className:"min-h-12 min-w-12 rounded-full bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground disabled:cursor-not-allowed disabled:opacity-60",type:"submit",disabled:k||!h.stageRunId||!h.kind||!h.file,children:t.upload.submitLabel})]})]})]})}var i=a(55),d=a.n(i);function o(e,t){return e?e.trim()||t:t}function c(e){let{artifacts:t,loading:a,strings:l}=e;return(0,s.jsxs)("section",{className:"pp-card p-6",children:[(0,s.jsxs)(r.BJ,{gap:2,children:[(0,s.jsx)("span",{className:"text-xs uppercase tracking-widest text-foreground/60",children:l.list.label}),(0,s.jsx)("h2",{className:"text-xl font-semibold tracking-tight",children:l.list.title})]}),(0,s.jsx)(r.BJ,{gap:4,className:"mt-6",children:a?(0,s.jsx)("div",{className:"rounded-2xl border border-border-1 bg-surface-2 p-4 text-sm text-foreground/60",children:l.list.loading}):0===t.length?(0,s.jsx)("div",{className:"rounded-2xl border border-border-1 bg-surface-2 p-4 text-sm text-foreground/60",children:l.list.empty}):t.map(e=>{var t,a,n,i;let c=function(e){if(!e)return null;if(e.startsWith("http"))return e;if(!e.startsWith("r2://"))return null;let t=e.split("/");if(t.length<4)return null;let a=t.slice(3).join("/");return"/api/artifacts/download?key=".concat(encodeURIComponent(a))}(e.uri),u=(t=l.notAvailable,(null==(a=e.lead)?void 0:a.title)?e.lead.title:e.candidateId?e.candidateId:t),x=e.candidateId;return(0,s.jsxs)("div",{className:"rounded-3xl border border-border-1 bg-surface-2 p-4",children:[(0,s.jsxs)(r.d2,{justify:"between",alignY:"center",className:"gap-4",children:[(0,s.jsxs)(r.BJ,{gap:1,children:[(0,s.jsx)("span",{className:"text-xs text-foreground/60",children:l.fields.candidate}),(0,s.jsx)("span",{className:"text-lg font-semibold",children:u}),(0,s.jsxs)("span",{className:"text-xs text-foreground/60",children:[l.fields.stage,": ",o(e.stage,l.notAvailable)]})]}),(0,s.jsxs)(r.BJ,{gap:2,className:"items-end text-xs",children:[x?(0,s.jsx)(d(),{className:"inline-flex min-h-12 min-w-12 items-center justify-center rounded-full border border-border-2 px-3 py-1",href:"/candidates/".concat(x),children:l.actions.viewCandidate}):null,c?(0,s.jsx)("a",{className:"inline-flex min-h-12 min-w-12 items-center justify-center rounded-full border border-border-2 px-3 py-1 text-primary",href:c,target:"_blank",rel:"noreferrer",children:l.actions.open}):null]})]}),(0,s.jsxs)(r.xA,{cols:1,gap:3,className:"mt-4 text-sm md:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-foreground/60",children:l.fields.kind}),(0,s.jsx)("div",{className:"font-semibold",children:o(e.kind,l.notAvailable)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-foreground/60",children:l.fields.created}),(0,s.jsx)("div",{className:"font-semibold",children:(n=e.createdAt,i=l.notAvailable,null!=n?n:i)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-foreground/60",children:l.fields.uri}),(0,s.jsx)("div",{className:"font-semibold break-all",children:o(e.uri,l.notAvailable)})]})]})]},e.id)})})]})}function u(e){let{strings:t}=e,[a,r]=(0,l.useState)([]),[i,d]=(0,l.useState)(!0),o=(0,l.useCallback)(async()=>{d(!0);try{let e=await fetch("/api/artifacts?limit=50");if(!e.ok)return;let t=await e.json();t.ok&&Array.isArray(t.artifacts)&&r(t.artifacts)}catch(e){console.error(e)}finally{d(!1)}},[]);return(0,l.useEffect)(()=>{o()},[o]),(0,s.jsxs)("div",{className:"grid gap-6",children:[(0,s.jsx)(n,{strings:t,onUploaded:o}),(0,s.jsx)(c,{artifacts:a,loading:i,strings:t})]})}},9987:(e,t,a)=>{Promise.resolve().then(a.bind(a,7467)),Promise.resolve().then(a.bind(a,6423)),Promise.resolve().then(a.bind(a,368)),Promise.resolve().then(a.bind(a,8634)),Promise.resolve().then(a.bind(a,5016)),Promise.resolve().then(a.bind(a,9602)),Promise.resolve().then(a.bind(a,9633)),Promise.resolve().then(a.bind(a,1875)),Promise.resolve().then(a.bind(a,6884)),Promise.resolve().then(a.bind(a,5216)),Promise.resolve().then(a.bind(a,124)),Promise.resolve().then(a.bind(a,4274))}},e=>{var t=t=>e(e.s=t);e.O(0,[2827,9683,7106,55,4668,8902,9956,2459,7358],()=>t(9987)),_N_E=e.O()}]);