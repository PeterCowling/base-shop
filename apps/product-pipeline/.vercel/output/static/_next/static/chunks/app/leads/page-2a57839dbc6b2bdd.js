(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1362],{1909:(e,l,t)=>{"use strict";t.d(l,{default:()=>n});var s=t(6586),r=t(7826),a=t(8902);function n(e){let{strings:l}=e,[t,n]=(0,r.useState)([]),[d,i]=(0,r.useState)(!0),[o,c]=(0,r.useState)(!1),[u,b]=(0,r.useState)(!1),[h,x]=(0,r.useState)([]),[m,p]=(0,r.useState)({title:"",url:""}),f=(0,r.useCallback)(async()=>{i(!0);try{let e=await fetch("/api/leads?limit=50");if(!e.ok)return;let l=await e.json();if(l.ok&&Array.isArray(l.leads)){n(l.leads);let e=new Set(l.leads.map(e=>e.id));x(l=>l.filter(l=>e.has(l)))}}catch(e){console.error(e)}finally{i(!1)}},[]);(0,r.useEffect)(()=>{f()},[f]);let g=(0,r.useMemo)(()=>t.filter(e=>"NEW"===e.status||"ON_HOLD"===e.status).map(e=>e.id),[t]),j=(0,r.useMemo)(()=>new Set(h),[h]),y=t.length>0&&t.every(e=>j.has(e.id)),v=(0,r.useCallback)(()=>{x(e=>{if(0===t.length)return e;let l=t.map(e=>e.id);return l.every(l=>e.includes(l))?[]:l})},[t]),w=(0,r.useCallback)(e=>{x(l=>l.includes(e)?l.filter(l=>l!==e):[...l,e])},[]),N=(0,r.useMemo)(()=>{if(0===h.length)return null;let e=new URLSearchParams;return e.set("ids",h.join(",")),"/api/exports/leads?".concat(e.toString())},[h]),k=(0,r.useCallback)(()=>{N&&window.location.assign(N)},[N]),C=(0,r.useCallback)(async e=>{if(0!==g.length){c(!0);try{await fetch("/api/stages/p/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leadIds:g,promotionLimit:e})})}catch(e){console.error(e)}finally{c(!1),await f()}}},[g,f]),P=(0,r.useCallback)(async e=>{e.preventDefault();let l=m.title.trim(),t=m.url.trim();if(l||t){b(!0);try{await fetch("/api/leads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:"manual",title:l||void 0,url:t||void 0})}),p({title:"",url:""}),await f()}catch(e){console.error(e)}finally{b(!1)}}},[m.title,m.url,f]);return(0,s.jsxs)("section",{className:"pp-card p-6",children:[(0,s.jsxs)(a.d2,{justify:"between",alignY:"center",className:"gap-4",children:[(0,s.jsxs)(a.BJ,{gap:2,children:[(0,s.jsx)("span",{className:"text-xs uppercase tracking-widest text-foreground/60",children:l.intakeLabel}),(0,s.jsx)("h2",{className:"text-xl font-semibold tracking-tight",children:l.intakeTitle})]}),(0,s.jsxs)(a.d2,{gap:2,alignY:"center",children:[(0,s.jsx)("button",{className:"min-h-12 min-w-12 rounded-full border border-border-2 px-4 py-2 text-sm disabled:cursor-not-allowed disabled:opacity-60",onClick:()=>void C(),disabled:o||0===g.length,type:"button",children:l.runStagePLabel}),(0,s.jsx)("button",{className:"min-h-12 min-w-12 rounded-full bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground disabled:cursor-not-allowed disabled:opacity-60",onClick:()=>void C(5),disabled:o||0===g.length,type:"button",children:l.promoteTopLabel}),(0,s.jsx)("button",{className:"min-h-12 min-w-12 rounded-full border border-border-2 px-4 py-2 text-sm disabled:cursor-not-allowed disabled:opacity-60",onClick:k,disabled:!N,type:"button",children:l.exportCsvLabel})]})]}),(0,s.jsxs)("form",{className:"mt-6 grid gap-4 md:grid-cols-3",onSubmit:P,children:[(0,s.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[l.leadLabel,(0,s.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:m.title,onChange:e=>p(l=>({...l,title:e.target.value})),disabled:u,type:"text"})]}),(0,s.jsxs)("label",{className:"text-xs uppercase tracking-widest text-foreground/60",children:[l.urlLabel,(0,s.jsx)("input",{className:"mt-2 w-full rounded-2xl border border-border-1 bg-surface-2 px-3 py-2 text-sm text-foreground shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",value:m.url,onChange:e=>p(l=>({...l,url:e.target.value})),disabled:u,type:"url"})]}),(0,s.jsx)("button",{className:"min-h-12 min-w-12 self-end rounded-full border border-border-2 px-4 py-2 text-sm font-semibold disabled:cursor-not-allowed disabled:opacity-60",type:"submit",disabled:u,children:l.submitLabel})]}),(0,s.jsx)("div",{className:"mt-6 overflow-hidden rounded-2xl border border-border-1",children:(0,s.jsxs)("table",{className:"pp-table","aria-busy":d,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:(0,s.jsx)("input",{type:"checkbox","aria-label":l.table.select,checked:y,onChange:v})}),(0,s.jsx)("th",{children:l.table.id}),(0,s.jsx)("th",{children:l.table.lead}),(0,s.jsx)("th",{children:l.table.source}),(0,s.jsx)("th",{children:l.table.triage}),(0,s.jsx)("th",{children:l.table.score}),(0,s.jsx)("th",{children:l.table.status})]})}),(0,s.jsx)("tbody",{children:d?Array.from({length:4}).map((e,l)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"py-4",children:(0,s.jsx)("div",{className:"h-3 w-3 rounded-full bg-foreground/10"})}),(0,s.jsx)("td",{className:"py-4",children:(0,s.jsx)("div",{className:"h-3 w-16 rounded-full bg-foreground/10"})}),(0,s.jsx)("td",{children:(0,s.jsx)("div",{className:"h-3 w-40 rounded-full bg-foreground/10"})}),(0,s.jsx)("td",{children:(0,s.jsx)("div",{className:"h-3 w-24 rounded-full bg-foreground/10"})}),(0,s.jsx)("td",{children:(0,s.jsx)("div",{className:"h-6 w-16 rounded-full bg-foreground/10"})}),(0,s.jsx)("td",{children:(0,s.jsx)("div",{className:"h-3 w-10 rounded-full bg-foreground/10"})}),(0,s.jsx)("td",{children:(0,s.jsx)("div",{className:"h-3 w-16 rounded-full bg-foreground/10"})})]},"skeleton-".concat(l))):t.map(e=>{var t,r,a,n,d,i;let o=null!=(r=null!=(t=e.title)?t:e.url)?r:l.notAvailable,c=null!=(n=null!=(a=e.source)?a:e.sourceContext)?n:l.notAvailable,u=null!=(d=e.triageScore)?d:l.notAvailable,b=e.triageBand?e.triageBand.toUpperCase():l.notAvailable,h=null!=(i=e.status)?i:l.notAvailable;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"checkbox","aria-label":"".concat(l.table.select," ").concat(l.table.lead),checked:j.has(e.id),onChange:()=>w(e.id)})}),(0,s.jsx)("td",{className:"font-mono text-xs text-foreground/70",children:e.id}),(0,s.jsx)("td",{className:"font-semibold",children:o}),(0,s.jsx)("td",{className:"text-sm text-foreground/70",children:c}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"rounded-full border border-border-2 px-2 py-1 text-xs",children:b})}),(0,s.jsx)("td",{className:"font-semibold",children:u}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"text-xs text-foreground/60",children:h})})]},e.id)})})]})})]})}},3264:(e,l,t)=>{Promise.resolve().then(t.bind(t,1909)),Promise.resolve().then(t.bind(t,6423)),Promise.resolve().then(t.t.bind(t,55,23)),Promise.resolve().then(t.bind(t,368)),Promise.resolve().then(t.bind(t,8634)),Promise.resolve().then(t.bind(t,5016)),Promise.resolve().then(t.bind(t,9602)),Promise.resolve().then(t.bind(t,9633)),Promise.resolve().then(t.bind(t,1875)),Promise.resolve().then(t.bind(t,6884)),Promise.resolve().then(t.bind(t,5216)),Promise.resolve().then(t.bind(t,124)),Promise.resolve().then(t.bind(t,4274))}},e=>{var l=l=>e(e.s=l);e.O(0,[2827,9683,7106,55,4668,8902,9956,2459,7358],()=>l(3264)),_N_E=e.O()}]);