/* apps/cms/src/app/globals.css
   CMS-wide globals powered by design-system tokens                    */
@config "../../../../tailwind.config.mjs";

/* Import base theme first for layout primitives; override colors/fonts below */
@import "../../../../packages/themes/base/src/tokens.css";
/* CMS-only tokens to prevent base theme bleed-through */
@import "./cms.tokens.css";
@import "../../../../packages/ui/src/styles/builder.css";
@import "tailwindcss";
/* Override Tailwind Forms base styles with token-driven colors
   so dark mode via `.theme-dark` is honored. */
@import "../../../../packages/ui/src/styles/forms.css";
/* CMS a11y and layout utilities */
@import "./utilities.a11y.css";

/* -------- CSS reset (minimal) ------------------------------------ */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  padding: 0;
  min-height: 100%;
  background: hsl(var(--color-bg));
  color: hsl(var(--color-fg));
  font-family: var(--font-sans);
  -webkit-font-smoothing: antialiased;
}

/* link & button helpers */
a {
  /* Inherit text color so buttons/variants control anchor contrast. */
  color: inherit;
  text-decoration: none;
}
a:hover {
  text-decoration: underline;
}
button {
  font-family: inherit;
}

/* CMS surface utilities and overrides */
/* Surface utilities now provided via Tailwind theme colors */

/* Improve readability of muted helper text within the CMS.
   Our preset sets text-muted-foreground to 65% alpha of --color-fg,
   which looked too faint on layered CMS surfaces. Bump to ~78% here. */
.text-muted-foreground { color: hsl(var(--color-fg) / 0.85); }

/* Keyboard key styling for inline <kbd> elements used in Page Builder tips
   and the shortcuts dialog. Keeps contrast and affordance consistent across
   light/dark surfaces without relying on UA default styles. */
kbd {
  display: inline-block;
  padding: 0 0.4em;
  border-radius: 0.375rem; /* ~6px */
  background: hsl(var(--surface-3));
  color: hsl(var(--color-fg));
  border: 1px solid hsl(var(--color-fg) / 0.25);
  box-shadow: inset 0 -1px 0 hsl(var(--color-bg) / 0.6);
  font-family: var(--font-mono);
  font-size: 0.85em;
  line-height: 1.6;
}

/* -------- Text wrapping & overflow safety ------------------------ */
/*
   Ensure long user-provided text (names, emails, slugs, URLs) does not
   bleed outside components. We scope these rules to the CMS content area
   (see LayoutClient) to avoid side effects in other apps.
*/
.cms-content :where(h1,h2,h3,h4,h5,h6,p,span,small,li,dt,dd,blockquote,label,a,strong,em,code,div) {
  overflow-wrap: anywhere; /* allow breaking very long tokens */
  word-break: break-word;  /* fallback for older engines */
  hyphens: auto;           /* nicer wrapping where supported */
}

/* In flex rows, allow text containers to shrink and wrap instead of
   forcing siblings (like status tags) to compress awkwardly. Apply the
   utility class `min-w-0` where needed in markup; this targets any
   element carrying it for clarity. */
.cms-content :where(.min-w-0) {
  min-width: 0 !important;
}

/* -------- Non-text intrinsic sizing ------------------------------------ */
/*
   Controls that render non-text content (SVGs, images, video) should not get
   clipped when placed inside tight flex containers. Prevent flex-shrink on
   the inner media and ensure it scales within the control bounds.
*/
.cms-content :where(button, [role="button"]) > svg {
  width: 1em;
  height: 1em;
  flex-shrink: 0;
  display: block; /* avoid baseline gaps/cropping inside fixed-height buttons */
}

/* Ensure embedded media respects its container without overflowing. */
.cms-content :where(img, svg, canvas, video, iframe) {
  max-width: 100%;
  max-height: 100%;
}

/* -------- Viewport-safe height utilities ------------------------------- */
/* Replace unsafe 100vh/100vw with dynamic viewport units for mobile UI */
.min-h-dvh { min-height: 100dvh; }
.h-dvh { height: 100dvh; }
