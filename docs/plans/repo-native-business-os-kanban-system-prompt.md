---
Type: Guide
Status: Draft
Domain: Business OS / Kanban
Last-reviewed: 2026-01-28
Created: 2026-01-28
Last-updated: 2026-01-28
---

# Base-Shop Business OS + Kanban System (Repo-Native, Human + Agent Coordinated)

This is a repo-specific prompt + requirements spec for designing and implementing a repo-native “Business OS + Kanban” system inside **Base-Shop** (`/Users/petercowling/base-shop`). It is written so a reviewer can critique the requirements **without repo access**, by including a snapshot of what exists today and the operational constraints.

## 1) Repo Reality Snapshot (Base-Shop, as of 2026-01-28)

### Identity & Tooling

- Repo name: Base-Shop (`README.md`)
- Workspace package name: `cms-monorepo` (`package.json`)
- Conventions:
  - Apps: `@apps/<app>` (e.g., `@apps/cms`, `@apps/brikette`)
  - Packages: `@acme/<pkg>` (e.g., `@acme/platform-core`, `@acme/design-system`, `@acme/ui`)
- Runtime/tooling:
  - Node.js `>=20`
  - `pnpm@10.12.1`
  - Turborepo + pnpm workspaces (`turbo.json`, `pnpm-workspace.yaml`)
- Web stack:
  - Next.js 15, React 19, TypeScript, Tailwind 4
- Quality gates already present:
  - `AGENTS.md` (universal runbook)
  - `docs/testing-policy.md` (targeted tests; no unfiltered `pnpm test`)
  - `scripts/validate-changes.sh` (typecheck + lint + targeted tests)

### Existing Layout

- `apps/` — many apps/workers (including `apps/dashboard`)
- `packages/` — shared libs (including UI/design system)
- `docs/` — extensive documentation system:
  - `docs/AGENTS.docs.md` (taxonomy/conventions)
  - `docs/registry.json` (generated by `pnpm docs:lint`)
  - `docs/plans/*`, `docs/cms-plan/*`, `IMPLEMENTATION_PLAN.md`
- Agent workflow already standardized:
  - `.claude/skills/*/SKILL.md`
  - `docs/agents/feature-workflow-guide.md`
  - overlays: `CODEX.md`, `CLAUDE.md`
  - safety rationale: `.agents/safety/*`

### Existing “board” hazard

There is already a lane-based workboard in `apps/dashboard/src/pages/workboard.tsx` (CMS-fed, not repo-backed, lanes unrelated to our kanban).

**Decision:** Business OS Kanban ships as a **separate app**. We must prevent confusion with the dashboard workboard via naming/scope boundaries.

## 2) Objective

We have a large number of opportunities across existing businesses (operate + improve) and new businesses (develop + launch + operate + improve). We need a single coordinated system where humans and agents can:

- generate and capture ideas/opportunities
- work them up to a standard
- fact-find
- plan
- do/build
- reflect
- convert reflection into updated business plans, people responsibilities, and new ideas

This system is ERP-like in breadth (everything in scope: engineering, ops, marketing, finance, supply chain, property, partnerships, hiring, legal, etc.) but not ERP-like in implementation. The UI must be extremely user-friendly; the agent machinery mostly stays in-repo.

The system delivers three linked outcomes:

1. A Kanban app in this monorepo (Next.js app under `apps/*`, reusing `@acme/design-system` / `@acme/ui`).
2. An extension of the existing agent discipline to cover **Ideas → Fact-find → Plan → Build/Do → Reflect** for non-coding work with the same rigor (risk-managed, evidence-gated).
3. A repo-native documentation layer (business plans + people) tied directly to kanban execution.

## 3) Phase 0 Operating Constraints (hard constraints)

- **Single agent runner:** only Pete can run agents against the repo initially.
- **No agent APIs:** the app must not call agents via API. Pete runs prompts manually; outputs land as normal git changes.
- **Phase 0 single human user:** only Pete uses the Business OS app in Phase 0 (no multi-user access).
- **Agent-run kanban updates are manual:** agent-generated updates to cards/lanes/plans/people happen only when Pete runs agents; the app has no background/scheduled agent runs (user submissions via the app are separate).
- **Repo write model (Phase 0):** the app commits to `work/**` branches and pushes only on explicit **Sync**; the repo’s existing auto-PR workflow creates a PR and auto-merges after CI passes (no manual review step).
  - Phase 0 UI does not poll GitHub for PR/merge status; it only provides "Find PR" / "Compare" links.
- **Commit authorship:** commits must use the real user identity (name/email) or an agent name when an agent is the author of the change.
- **Plan/People editing permissions:** only Pete and agents may edit business plans and people docs.
- **Lane move proposals:** only Pete and agents may propose lane moves.
- **Docs taxonomy alignment:** Option A is required in Phase 0 (Business OS docs are included in `docs:lint` + `docs/registry.json`).

## 4) App Placement

- Create a separate app: `apps/business-os` (package name `@apps/business-os`)
- Stack: Next.js 15 / React 19 / TS / Tailwind 4
- Reuse: `@acme/design-system`, `@acme/ui` wherever possible
- All code changes must follow existing runbooks and validation gates:
  - `AGENTS.md`, `docs/testing-policy.md`, `scripts/validate-changes.sh`

## 5) Canonical Repo Storage (repo-backed source of truth)

Business OS artifacts live under a dedicated subtree:

```
docs/business-os/
  strategy/
    businesses.json
    PLAT/
      plan.user.md
      plan.agent.md
    <BIZ>/
      plan.user.md
      plan.agent.md
  people/
    people.user.md
    people.agent.md
  ideas/
    inbox/
      <ID>.user.md
      <ID>.agent.md
      archive/
    worked/
      <ID>.user.md
      <ID>.agent.md
      archive/
  cards/
    <ID>.user.md
    <ID>.agent.md
    <ID>/
      fact-find.user.md
      fact-find.agent.md
      plan.user.md
      plan.agent.md
      build.user.md
      build.agent.md
      reflect.user.md
      reflect.agent.md
    archive/
  boards/
    <BIZ>.board.json
    global.board.json
  scans/
    last-scan.json
    active-docs.json
    history/
```

### Archive policy (hard)

When an item becomes **Dropped** or **Retired**:

- update status fields appropriately, and
- move it into the relevant `archive/` directory.

UI requirement: archived items are hidden (not shown in normal lists/search/boards).

## 6) Docs Taxonomy Alignment (Option A, Phase 0)

Business OS docs must be fully integrated into the repo’s documentation system:

- Extend `docs/AGENTS.docs.md` to include:
  - allowed Business OS doc types,
  - required frontmatter keys per type,
  - conventions for `.agent.md` / `.user.md` pairings.
- Update the implementation behind `pnpm docs:lint` so it:
  - includes `docs/business-os/**`,
  - validates required frontmatter (**hard errors**),
  - emits warnings for “strongly recommended” fields (see evidence gates),
  - indexes Business OS docs into `docs/registry.json`.

Goal: `docs/registry.json` becomes a unified index for both existing docs and Business OS docs.

Repo note (today): `pnpm docs:lint` already walks all of `docs/**` and writes `docs/registry.json`, but does not yet validate Business OS–specific required fields (beyond the repo’s generic doc header checks).

Operational note (Phase 0): `docs/registry.json` is updated on explicit **Sync** (RepoStore Sync runs `pnpm docs:lint` and commits the updated registry before pushing). Save does not update the registry.

Repo reality note (as of 2026-01-28): `pnpm docs:lint` currently exits non-zero due to legacy docs missing headers. Phase 0 Sync uses docs:lint primarily as a **registry generator** and must not be blocked by the non-zero exit code; instead surface the output as warnings and proceed.

## 7) Canonical IDs and Business Catalog

### Business catalog

Canonical list lives in:

`docs/business-os/strategy/businesses.json`

It must include at minimum:

- `code` (e.g., `BRIK`, `SKYL`, `PLAT`)
- `name`
- `description`
- `apps` / `packages` associations (optional but supported)
- `defaultOwners` / responsibility mapping hooks
- board visibility settings (optional)
- `active` / `archived` status (supported)

### PLAT rule (UPDATED)

`PLAT` is treated exactly like any other business code.

- No special priority boost.
- Same dependency rules as every other business.
- Same board/filter/ordering semantics.

### ID format (hard)

Opportunity/Idea ID and Card ID:

`<BIZ>-OPP-####`

Examples:

- `BRIK-OPP-0123`
- `PLAT-OPP-0042`

## 8) Core Concepts and Process Rules

### Ideas vs cards (hard rule)

- “Idea” and “Opportunity” are synonyms.
- Two states:
  - Raw idea (draft): stored in `ideas/inbox/`, not visible on kanban boards.
  - Worked-up idea: stored in `ideas/worked/`, must have a card.
- Rule: **worked-up idea ⇒ card exists; raw idea ⇒ no card yet.**

### Raw idea visibility (UI)

Phase 0: raw ideas are visible only to Pete (because Pete is the only user).

Phase 1+: raw ideas should be visible to Pete plus the submitting user and/or assigned owner (requires real auth/identity).

### Ownership (Phase 0)

- Every idea and card has a human owner.
- No agent ownership in Phase 0.
- Default owner for raw idea submission: submitter (default).

### Priority (hard)

- Priority scale: P0–P5
- Global board includes all cards where Priority ∈ {P0,P1}.

### Ordering (computed)

No manual ordering. Within each lane:

1. priority (P0 → P5)
2. due date (earliest first; missing last)
3. last-updated (most recent first)
4. created (most recent first)

## 9) Dual-Audience Documents (Business OS artifacts)

Every logical artifact under `docs/business-os/**` must have two versions:

- `*.user.md` (human/UI optimized)
- `*.agent.md` (agent optimized; rigorous structure)

People docs constraint: a change to one version implies a mirrored change to the other.

## 10) Boards and Lanes

### Boards

- One board per business code (`<BIZ>.board.json`)
- One global board (`global.board.json`) filtering Priority ∈ {P0,P1}

### Dependencies (UPDATED)

Dependencies are allowed across businesses, including `PLAT` ↔ other businesses, with cycle detection. No special-case behavior for `PLAT`.

### Lanes (fixed, universal)

Inbox (Ideas) → Fact-finding → Planned → In progress → Blocked → Done → Reflected

### Single source of truth

Lane lives in the **card frontmatter** (in `docs/business-os/cards/<ID>.user.md`, mirrored to `docs/business-os/cards/<ID>.agent.md`); boards are derived views.

## 11) UI Requirements

### Card representations (human UI only)

Only `.user.md` is rendered in the app.

#### Board card (compact)

- Title
- Owner
- Priority
- Lane
- Next action
- Updated date
- Business (required on global board)

#### Card detail view (expanded)

- full title + one-sentence summary
- owner (+ contributors optional)
- priority + due date (optional)
- lane + Proposed-Lane (if present)
- embedded fine-grained task checklist
- risk & evidence gating (explicit fields + evidence source typing)
- dependencies (cards/external)
- links (doc-centric: plan/people/related cards/commits/PRs)
- lightweight history

### Card editing (Phase 0)

Phase 0 is Pete-only, and the app is a full editor for cards:

- Pete can create/update cards in the app, including updating `Lane` and `Proposed-Lane`.
- Lane changes must ensure always-on stage docs exist (Fact-finding/Planned/In progress/Reflected mapping).

### Plans and people in the app (read-only, presentation formatted)

The app must render:

- business plans (`docs/business-os/strategy/<BIZ>/plan.user.md`)
- people (`docs/business-os/people/people.user.md`)

…in a user-friendly, presentation-optimized view.

### Change request interaction

Users can:

- click a displayed plan/people element and request a change
- add a general comment/request without selecting an element

These requests must not directly modify plan/people docs (since only Pete/agents can edit those docs).

## 12) Repo Write Model (App → Git)

### Branch and review

- All app writes commit to `work/**` branches.
- No manual review step; existing auto-PR workflow creates PRs and auto-merges after CI passes.
- Push policy (Phase 0):
  - **Save:** local commit(s) only (no push)
  - **Sync:** push to `origin` (PR/merge is asynchronous; surfaced via links only)

### Commit identity

Commit author must be:

- the real user identity (name/email), or
- an agent name (name/email) when authored by an agent-run change.

### Path-level authorization (hard)

Phase 0 (Pete-only): enforce a strict allowlist at the server layer, but it is **not user-specific**:

- Writes allowed only under `docs/business-os/**` (plus explicitly enumerated exceptions, if any).
- Writes denied to all other paths under `docs/**` and repo root.
 - Phase 0 explicitly allows card lane changes (Pete can edit `Lane` and `Proposed-Lane`).

Phase 1+ (multi-user): add user-scoped permissions:

- Non-Pete users: only `docs/business-os/ideas/inbox/**` (new raw ideas, append comments) and `docs/business-os/cards/**` (append comments only; no lane changes; no proposals)
- Only Pete/agents may modify: `docs/business-os/strategy/**`, `docs/business-os/people/**`, `docs/business-os/boards/**`, `docs/business-os/scans/**`, and card lane/proposal fields in frontmatter

### Minimizing conflicts

- Use append-only comment logs where possible.
- When a write touches an existing file:
  - **Save:** write + local commit (no push)
  - **Sync:** `fetch` → merge remote work branch → merge `origin/main` → push
  - **No destructive git ops:** never rebase, never force-push
  - On merge conflicts: fail fast and require manual resolution in the dedicated worktree (block further writes until resolved)

## 13) Change Requests for Plans and People

Since users cannot edit plan/people docs directly, the app must implement change requests as repo artifacts.

### Mechanism (Phase 0)

A plan/people change request is created as a raw idea in `docs/business-os/ideas/inbox/` with:

- a normal `<BIZ>-OPP-####` ID
- metadata indicating it is a change request
- a comment log capturing the user’s request
- optional anchoring metadata when the request is tied to a specific element (e.g., a heading ID or stable reference)

## 14) Evidence Gates and Source Typing

Evidence gates are strongly recommended in Phase 0 (warnings only), but must be structurally supported in documents/UI.

### Evidence source typing (required)

Whenever evidence is recorded, it must be typed using a fixed set, e.g.:

- measurement
- customer-input
- repo-diff
- experiment
- financial-model
- vendor-quote
- legal
- assumption
- other

(Exact enum can evolve; must be consistent and validated by docs tooling.)

## 15) Lane transitions and stage documents (Option 2: always-on)

Rule: when a card enters a lane, the corresponding stage docs must exist and be maintained, even if short.

Mapping:

- Fact-finding → ensure `docs/business-os/cards/<ID>/fact-find.(user|agent).md`
- Planned → ensure `docs/business-os/cards/<ID>/plan.(user|agent).md`
- In progress → ensure `docs/business-os/cards/<ID>/build.(user|agent).md`
- Reflected → ensure `docs/business-os/cards/<ID>/reflect.(user|agent).md`
- Blocked → record block reason and evidence in relevant stage docs + card

Small task breakdown remains embedded in the card detail view; stage docs are still mandatory per lane as above.

## 16) Lane move proposals (repo representation)

Lane moves are proposed/approved only by Pete/agents.

Repo representation (hard):

- A lane move proposal is represented in card frontmatter:
  - `Proposed-Lane: <LaneName>`

## 17) Agent Responsibilities (manual-run model, reuse existing discipline)

All agent work must follow:

- `AGENTS.md`
- `docs/testing-policy.md`
- `scripts/validate-changes.sh`
- existing `.claude/skills/*/SKILL.md` workflows (extend, don’t reinvent)

Agent duties (Pete-triggered only in Phase 0):

- work up raw ideas into standardized worked ideas
- create/update cards and always-on stage docs as lanes progress
- propose lane moves (via `Proposed-Lane`) with evidence references
- update business plans/people docs in response to execution/reflection
- run scans:
  - commits since last scan
  - uncommitted changes since last scan
- maintain:
  - `docs/business-os/scans/last-scan.json`
  - `docs/business-os/scans/active-docs.json`

## 18) Archived items

Dropped/Retired items must be status-changed and moved to archive.

UI must hide archived items (no normal browse/search/boards show them).
