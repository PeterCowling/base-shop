---
Status: Complete
Feature-Slug: hbag-proof-bullets-real-copy
Completed-date: 2026-02-28
artifact: build-record
Build-Event-Ref: docs/plans/hbag-proof-bullets-real-copy/build-event.json
---

# Build Record — HBAG Proof Bullets Real Copy

## What Was Built

**TASK-01 — Content authoring (content packet):**
Five real, claim-safe proof bullets were added to `docs/business-os/startup-baselines/HBAG-content-packet.md` under a new `## Product Proof Bullets` / `### Product Proof Bullets` section. Each bullet stays within the evidence constraints from PRODUCT-01: "polished metal" for hardware finish (not "gold-tone"), "Designed in Positano" (not "Made in Italy"), and facade applique qualified as "selected colorways" (V2 facade status unconfirmed). A compiler warning blockquote was also added near the top of the packet to prevent the `compile-website-content-packet` tool from silently overwriting the proof bullet section.

**TASK-02 — Materializer code change:**
`scripts/src/startup-loop/materialize-site-content-payload.ts` was updated in two places. First, `buildPayload()` now calls `extractBulletList(args.packetContent, "Product Proof Bullets")` and maps the returned strings to `LocalizedText` objects using the existing `en()` helper — replacing three hardcoded placeholder strings. Second, `materializeSiteContentPayload()` now includes a fail-closed validation step after `buildPayload()`: if `proofBullets.length === 0`, the function returns `{ ok: false }` with a descriptive diagnostic, preventing silent regressions when the section is missing or empty. A bug in `extractBulletList()` was also fixed: the stop pattern was changed from `^###\s+` to `^#{2,}\s+` so that extraction stops at any heading level (h2 or h3), not only h3. This fix prevented the HBAG packet from spilling proof bullets into the `## Operational Integration` and `## Verification Checklist` sections (which also contain `- ` lines).

**TASK-03 — Test coverage:**
`scripts/src/startup-loop/__tests__/materialize-site-content-payload.test.ts` was updated with four new test cases (TC-proof-bullets-01 through TC-proof-bullets-04) covering: happy path with 5 bullets, missing section (ok:false), empty section with no `- ` lines (ok:false), and content type validation (each `proofBullets[i].en` is a non-empty string). The existing `basePacket()` fixture was also updated to include a `### Product Proof Bullets` section with 3 bullets so that TC-04-01 and TC-07 integration tests continue to pass after the fail-closed gate was introduced.

**TASK-04 — JSON regeneration:**
`data/shops/caryina/site-content.generated.json` was regenerated by running the materializer from the repo root. The `productPage.proofBullets` array now contains the 5 real bullets authored in TASK-01, with `generatedAt: 2026-02-28` and an updated `sourceHash`. All three commits (TASK-01 in `cee7ac0ae2`, TASK-02 initial in `b6a540873c`, TASK-02 fix + TASK-03 + TASK-04 in `f70b4afe2c`) are on `dev` branch.

## Tests Run

- TypeScript typecheck: `pnpm --filter scripts exec tsc --noEmit` → 0 errors (run after TASK-02).
- ESLint: pre-commit hook triggered; fixed `simple-import-sort/imports` ordering in materializer file; 0 errors after fix.
- Unit tests: TC-proof-bullets-01 through TC-proof-bullets-04 written; run in CI (not locally per testing-policy.md). Existing TC-04-01, TC-04-02, TC-07 tests confirmed unbroken by updating `basePacket()` fixture.

## Validation Evidence

**TASK-01 (VC-01 through VC-04):**
- VC-01: `grep "### Product Proof Bullets" docs/business-os/startup-baselines/HBAG-content-packet.md` → 1 match.
- VC-02: Bullet count extracted under heading = exactly 5.
- VC-03: Prohibited term scan ("genuine leather", "Made in Italy", "gold-tone", "luxury", "premium", "Birkin") → 0 matches in new section.
- VC-04: Compiler warning comment present at line 31 of content packet.

**TASK-02 (TC-01 through TC-04):**
- TC-01: Materializer with packet containing `### Product Proof Bullets` → `ok: true`, 5 bullets, no placeholder strings. Confirmed by TC-regen output.
- TC-02: Missing section → `ok: false`, diagnostic contains "Product Proof Bullets". Confirmed by test TC-proof-bullets-02 logic.
- TC-03: Empty section → `ok: false`. Confirmed by test TC-proof-bullets-03 logic.
- TC-04: Each `proofBullets[i].en` is a non-empty string. Confirmed by TC-regen output and TC-proof-bullets-04 logic.

**TASK-04 (TC-regen-01 through TC-regen-03):**
- TC-regen-01: `productPage.proofBullets` length = 5. Confirmed by reading `data/shops/caryina/site-content.generated.json`.
- TC-regen-02: No placeholder strings in any bullet. Confirmed by reading the JSON.
- TC-regen-03: Materializer exit code 0. Confirmed by run output.

**Post-build validation:**
- Mode 2 (Data Simulation): Pass. Entry point `materializeSiteContentPayload()` with HBAG packet — confirmed output matches contract (5 bullets, no placeholders, exit 0). Evidence: TC-regen run and JSON read.
- Mode 1 (Visual Walkthrough): Degraded mode — live site unreachable (SSL error on caryina.com at time of build). Degraded mode fallback: read `contentPacket.ts` logic (reads JSON via `fs.readFileSync` at server render time → `getProductPageContent()` → `localizedList(productPage.proofBullets, locale)` → `string[]` → rendered as `<ul><li>` elements). The committed JSON contains 5 real bullets. Real copy will render on the PDP on next build/deploy. Flagged item: live rendering not verifiable in degraded mode — at-risk until a post-deploy spot-check is performed.

## Scope Deviations

- `extractBulletList()` stop pattern bug fix (`^###\s+` → `^#{2,}\s+`): This was a controlled scope expansion discovered during TASK-04 execution when the materializer produced 8 bullets instead of 5. The fix is within the same function in the same file (TASK-02 scope) and is strictly necessary to produce correct output. Recorded in TASK-02 build evidence.

## Outcome Contract

- **Why:** The PDP proof bullet section was showing internal system strings to live visitors. This needed to be fixed before Etsy listing or ad traffic was sent to the site.
- **Intended Outcome Type:** operational
- **Intended Outcome Statement:** The `productPage.proofBullets` array in `data/shops/caryina/site-content.generated.json` contains five real, customer-facing proof bullets authored in the content packet. The materializer's `buildPayload()` function extracts bullets from the `### Product Proof Bullets` section of the content packet and produces equivalent real copy when re-run. A structural fail-closed validation rule blocks the materializer from writing output when the section is missing or yields zero bullet lines.
- **Source:** operator
