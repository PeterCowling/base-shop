(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[148],{905:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var a=r(6586),i=r(7826),s=r(65),c=r(7862);let o=i.memo(function(t){let{amount:e,currency:r}=t,o=(0,s.Y)(),n=(0,i.useMemo)(()=>{var t;return t=(0,c.Tl)(o),new Intl.NumberFormat(t,{style:"currency",currency:r,currencyDisplay:"narrowSymbol"}).format(e/100)},[e,r,o]);return(0,a.jsx)("span",{children:n})})},1880:(t,e,r)=>{"use strict";r.d(e,{uP:()=>p,e:()=>d,jo:()=>m,n5:()=>u,d$:()=>o,_s:()=>n,P5:()=>l});let a=[{key:"sand",label:"Sand",hex:"hsl(var(--color-sand))"},{key:"ocean",label:"Ocean",hex:"hsl(var(--color-ocean))"},{key:"berry",label:"Berry",hex:"hsl(var(--color-berry))"}],i=[{key:"kids",label:"Kids"},{key:"adult",label:"Adult"}],s=(t,e)=>i.flatMap(r=>a.map(a=>({id:"".concat(t,"-").concat(r.key,"-").concat(a.key),size:r.key,color:a.key,colorLabel:a.label,colorHex:a.hex,price:e[r.key],currency:"USD",stripePriceId:"price_".concat(t,"_").concat(r.key,"_").concat(a.key),inStock:!0}))),c=[{id:"cochlearfit-classic",slug:"classic",name:"product.classic.name",style:"product.classic.style",shortDescription:"product.classic.shortDescription",longDescription:"product.classic.longDescription",featureBullets:["product.classic.feature1","product.classic.feature2","product.classic.feature3"],materials:["product.classic.material1","product.classic.material2"],careInstructions:["product.classic.care1","product.classic.care2","product.classic.care3"],compatibilityNotes:["product.classic.compatibility1","product.classic.compatibility2","product.classic.compatibility3"],images:[{src:"/images/classic-hero.svg",alt:"product.classic.image1Alt",width:820,height:520},{src:"/images/classic-detail.svg",alt:"product.classic.image2Alt",width:820,height:520}],variants:s("classic",{kids:3400,adult:3800})},{id:"cochlearfit-sport",slug:"sport",name:"product.sport.name",style:"product.sport.style",shortDescription:"product.sport.shortDescription",longDescription:"product.sport.longDescription",featureBullets:["product.sport.feature1","product.sport.feature2","product.sport.feature3"],materials:["product.sport.material1","product.sport.material2"],careInstructions:["product.sport.care1","product.sport.care2","product.sport.care3"],compatibilityNotes:["product.sport.compatibility1","product.sport.compatibility2","product.sport.compatibility3"],images:[{src:"/images/sport-hero.svg",alt:"product.sport.image1Alt",width:820,height:520},{src:"/images/sport-detail.svg",alt:"product.sport.image2Alt",width:820,height:520}],variants:s("sport",{kids:3600,adult:4e3})}];function o(){return c}function n(t){for(let e of c){let r=e.variants.find(e=>e.id===t);if(r)return r}}function l(t,e,r){return t.variants.find(t=>t.size===e&&t.color===r)}function u(t){var e;let r=t.variants[0];if(!r)throw Error("Product has no variants");return null!=(e=t.variants.find(t=>t.inStock))?e:r}function d(t){let e=new Set;for(let r of t.variants)e.add(r.size);return i.map(t=>t.key).filter(t=>e.has(t))}function p(t){let e=new Set;for(let r of t.variants)e.add(r.color);return a.map(t=>t.key).filter(t=>e.has(t))}function m(t){var e,r;return null!=(r=null==(e=a.find(e=>e.key===t))?void 0:e.hex)?r:"hsl(var(--color-fg))"}},4625:(t,e,r)=>{"use strict";r.d(e,{default:()=>m});var a=r(6586),i=r(7826),s=r(5876),c=r(6024),o=r(6233),n=r(6157),l=r(905),u=r(6662);let d=i.memo(function(t){let{onClick:e,disabled:r,isLoading:s,label:c,loadingLabel:o}=t,n=(0,i.useMemo)(()=>s?o:c,[s,c,o]);return(0,a.jsx)(u.A,{type:"button",onClick:e,disabled:r||s,children:n})});var p=r(65);let m=i.memo(function(){let t=(0,s.c3)(),e=(0,p.Y)(),{items:r,subtotal:u,currency:m}=(0,c._)(),[y,f]=(0,i.useState)(!1),[h,v]=(0,i.useState)(null),b=(0,i.useMemo)(()=>(0,o.$)(r),[r]),x=r.length>0,g=(0,i.useMemo)(()=>({items:r.map(t=>({variantId:t.variantId,quantity:t.quantity})),locale:e}),[r,e]),k=(0,i.useCallback)(async()=>{if(x){v(null),f(!0);try{let t=await (0,n.f)(g);window.location.href=t.url}catch(e){v(t("checkout.error")),f(!1)}}},[x,g,t]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"surface rounded-3xl border border-border-1 p-5",children:[(0,a.jsx)("div",{className:"text-xs font-semibold uppercase tracking-widest text-muted-foreground",children:t("checkout.review")}),(0,a.jsxs)("div",{className:"mt-4 space-y-3 text-sm",children:[b.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:t(e.product.name)}),(0,a.jsxs)("div",{className:"text-muted-foreground",children:[t("size.".concat(e.variant.size))," / ",t("color.".concat(e.variant.color))]})]}),(0,a.jsxs)("div",{className:"text-end",children:[(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[t("checkout.qty")," ",e.item.quantity]}),(0,a.jsx)("div",{className:"font-semibold",children:(0,a.jsx)(l.A,{amount:e.variant.price*e.item.quantity,currency:e.variant.currency})})]})]},e.item.variantId)),(0,a.jsxs)("div",{className:"flex items-center justify-between border-t border-border-1 pt-3 text-base font-semibold",children:[(0,a.jsx)("span",{children:t("checkout.total")}),(0,a.jsx)(l.A,{amount:u,currency:m})]})]})]}),h?(0,a.jsx)("div",{className:"rounded-2xl border border-red-200 bg-red-50 p-4 text-sm text-red-700",children:h}):null,(0,a.jsx)(d,{onClick:k,disabled:!x,isLoading:y,label:t("checkout.pay"),loadingLabel:t("checkout.loading")})]})})},6024:(t,e,r)=>{"use strict";r.d(e,{CartProvider:()=>y,_:()=>f});var a=r(6586),i=r(7826),s=r(7718);let c={items:[],updatedAt:0},o=t=>({items:t,updatedAt:Date.now()}),n=t=>t.map(t=>({variantId:t.variantId,quantity:(0,s.pE)(t.quantity)})).filter(t=>t.variantId&&t.quantity>=s.yY);function l(t,e){switch(e.type){case"hydrate":return o(n(e.payload));case"add":{let{variantId:r,quantity:a}=e.payload,i=[...t.items],c=i.findIndex(t=>t.variantId===r),n=(0,s.pE)(a);if(c>=0){let t=i[c];if(!t)return o(i);i[c]={variantId:t.variantId,quantity:(0,s.pE)(t.quantity+n)}}else i.push({variantId:r,quantity:n});return o(i)}case"remove":return o(t.items.filter(t=>t.variantId!==e.payload.variantId));case"setQuantity":return o(n(t.items.map(t=>t.variantId!==e.payload.variantId?t:{...t,quantity:(0,s.pE)(e.payload.quantity)})));case"clear":return o([]);default:return t}}let u="cochlearfit:cart",d=t=>!!t&&"object"==typeof t&&"string"==typeof t.variantId&&"number"==typeof t.quantity&&t.quantity>=s.yY;var p=r(6233);let m=(0,i.createContext)(null);function y(t){let{children:e}=t,[r,o]=(0,i.useReducer)(l,c),n=(0,i.useMemo)(()=>(0,p.m)(r),[r]),y=(0,i.useCallback)((t,e)=>{o({type:"add",payload:{variantId:t,quantity:e}})},[]),f=(0,i.useCallback)(t=>{o({type:"remove",payload:{variantId:t}})},[]),h=(0,i.useCallback)((t,e)=>{o({type:"setQuantity",payload:{variantId:t,quantity:e}})},[]),v=(0,i.useCallback)(()=>{o({type:"clear"})},[]),b=(0,i.useCallback)(()=>{let t=function(){let t=window.localStorage.getItem(u);if(!t)return null;try{let e=JSON.parse(t);if(!e||1!==e.version||!Array.isArray(e.items))return null;return e.items.filter(d).map(t=>({variantId:t.variantId,quantity:(0,s.pE)(t.quantity)}))}catch(t){return null}}();t&&t.length>0&&o({type:"hydrate",payload:t})},[]);(0,i.useEffect)(()=>{b()},[b]),(0,i.useEffect)(()=>{let t={version:1,items:r.items.map(t=>({variantId:t.variantId,quantity:(0,s.pE)(t.quantity)}))};window.localStorage.setItem(u,JSON.stringify(t))},[r.items]);let x=(0,i.useMemo)(()=>({items:r.items,itemCount:n.itemCount,subtotal:n.subtotal,currency:n.currency,addItem:y,removeItem:f,setQuantity:h,clear:v}),[y,v,f,h,r.items,n]);return(0,a.jsx)(m.Provider,{value:x,children:e})}function f(){let t=(0,i.useContext)(m);if(!t)throw Error("useCart must be used within CartProvider");return t}},6157:(t,e,r)=>{"use strict";var a;r.d(e,{f:()=>c,J:()=>o});let i=null!=(a=r(7811).env.NEXT_PUBLIC_API_BASE_URL)?a:"";function s(t){return"".concat(i).concat(t)}async function c(t){let e=await fetch(s("/api/checkout/session"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw Error("Failed to create checkout session");return await e.json()}async function o(t){let e=await fetch(s("/api/checkout/session/".concat(t)),{method:"GET"});if(!e.ok)throw Error("Failed to fetch checkout session");return await e.json()}},6233:(t,e,r)=>{"use strict";r.d(e,{$:()=>s,m:()=>i});var a=r(1880);function i(t){let e=0,r=0,i="USD";for(let s of t.items){let t=(0,a._s)(s.variantId);t&&(e+=s.quantity,r+=s.quantity*t.price,i=t.currency)}return{itemCount:e,subtotal:r,currency:i}}function s(t){let e=(0,a.d$)(),r=new Map;for(let t of e)for(let e of t.variants)r.set(e.id,{product:t,variant:e});return t.flatMap(t=>{let e=r.get(t.variantId);return e?[{item:t,product:e.product,variant:e.variant}]:[]})}},6662:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var a=r(6586),i=r(7826);let s=i.memo(function(t){let{variant:e="primary",className:r,...s}=t,c=(0,i.useMemo)(()=>["inline-flex","min-h-12","items-center","justify-center","rounded-full","px-5","text-sm","font-semibold","tracking-wide","transition","focus-visible:focus-ring","disabled:cursor-not-allowed","disabled:opacity-60",...{primary:["bg-primary","text-primary-foreground","hover:bg-accent"],outline:["border","border-border-1","text-foreground","hover:border-primary/70","hover:text-accent"],ghost:["text-foreground","hover:text-accent"]}[e],r].filter(Boolean).join(" "),[r,e]);return(0,a.jsx)("button",{...s,className:c})})},7363:(t,e,r)=>{Promise.resolve().then(r.bind(r,4625))},7718:(t,e,r)=>{"use strict";r.d(e,{_x:()=>i,pE:()=>s,yY:()=>a});let a=1,i=10;function s(t){return Number.isNaN(t)||t<a?a:t>i?i:Math.floor(t)}}},t=>{var e=e=>t(t.s=e);t.O(0,[106,132,956,889,358],()=>e(7363)),_N_E=t.O()}]);