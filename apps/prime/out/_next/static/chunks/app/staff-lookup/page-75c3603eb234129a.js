(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[840],{732:(e,t,s)=>{Promise.resolve().then(s.bind(s,2801))},1319:(e,t,s)=>{"use strict";s.d(t,{b:()=>o,r:()=>n});var a=s(6586),r=s(7826);let l=(0,r.createContext)(null);function n(e){let{children:t}=e,[s,n]=(0,r.useState)(null),[o,c]=(0,r.useState)(null);async function i(e){if(e.length>=4){let e="user_".concat(Date.now());return n({id:e}),c("staff"),localStorage.setItem("prime_role","staff"),localStorage.setItem("prime_user_id",e),!0}return!1}return(0,r.useEffect)(()=>{let e=localStorage.getItem("prime_role"),t=localStorage.getItem("prime_user_id");e&&t&&(c(e),n({id:t}))},[]),(0,a.jsx)(l.Provider,{value:{user:s,role:o,isAuthenticated:!!s,login:i,logout:function(){n(null),c(null),localStorage.removeItem("prime_role"),localStorage.removeItem("prime_user_id")}},children:t})}function o(){let e=(0,r.useContext)(l);if(!e)throw Error("usePinAuth must be used within a PinAuthProvider");return e}},2801:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var a=s(6586),r=s(4701),l=s(3920),n=s(5682);let o=(0,n.A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),c=(0,n.A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),i=(0,n.A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),d=(0,n.A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),u=(0,n.A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),m=(0,n.A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var x=s(9528),h=s(7826),f=s(1319);let p={"staffLookup.back":"Back","staffLookup.title":"Staff Lookup","staffLookup.subtitle":"Look up guest check-in details","staffLookup.placeholder":"Enter check-in code","staffLookup.loading":"Looking up...","staffLookup.errors.codeNotFound":"Code not found","staffLookup.errors.codeExpired":"Code has expired","staffLookup.errors.lookupFailed":"Lookup failed","staffLookup.tryAgain":"Please try again","staffLookup.guestName":"Guest Name","staffLookup.room":"Room","staffLookup.nights":"Nights","staffLookup.dates":"Dates","staffLookup.eta":"Expected Arrival","staffLookup.payment":"Payment Due","stay.night":"night","stay.nights":"nights","cash.cityTax.label":"City Tax","cash.deposit.label":"Deposit","cash.total":"Total Due","eta.methods.bus":"Bus","eta.methods.ferry":"Ferry","eta.methods.taxi":"Taxi","eta.methods.car":"Car"},g=e=>p[e]||e;function y(){var e;let t=(0,x.useRouter)(),s=(0,x.useSearchParams)(),{role:n,user:p}=(0,f.b)(),y=null!=(e=s.get("code"))?e:"",[j,b]=(0,h.useState)(y),[N,k]=(0,h.useState)(!1),[v,w]=(0,h.useState)(null),[L,A]=(0,h.useState)(null),S="staff"===n||"admin"===n||"owner"===n;async function C(e){if(e.trim()){k(!0),w(null),A(null);try{let t=await fetch("/api/check-in-lookup?code=".concat(encodeURIComponent(e.trim())));if(!t.ok)return void(404===t.status?w("codeNotFound"):410===t.status?w("codeExpired"):w("lookupFailed"));let s=await t.json();A(s)}catch(e){console.error("Error fetching guest data:",e),w("lookupFailed")}finally{k(!1)}}}return((0,h.useEffect)(()=>{if(!p)return void t.push("/");p&&n&&!S&&t.push("/")},[p,n,S,t]),(0,h.useEffect)(()=>{y&&S&&C(y)},[y,S]),p&&n)?S?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 p-4",children:(0,a.jsxs)("div",{className:"mx-auto max-w-md",children:[(0,a.jsxs)("div",{className:"mb-6 flex items-center gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>t.back(),className:"rounded-full p-2 hover:bg-gray-200","aria-label":g("staffLookup.back"),children:(0,a.jsx)(r.A,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:g("staffLookup.title")}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:g("staffLookup.subtitle")})]})]}),(0,a.jsx)("form",{onSubmit:function(e){e.preventDefault(),C(j)},className:"mb-6",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:j,onChange:e=>b(e.target.value.toUpperCase()),placeholder:g("staffLookup.placeholder"),className:"flex-1 rounded-lg border border-gray-300 px-4 py-3 text-lg font-mono uppercase focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200",disabled:N}),(0,a.jsx)("button",{type:"submit",disabled:N||!j.trim(),className:"rounded-lg bg-blue-600 px-4 py-3 text-white hover:bg-blue-700 disabled:opacity-50",children:(0,a.jsx)(l.A,{className:"h-5 w-5"})})]})}),N&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"}),(0,a.jsx)("p",{className:"mt-4 text-gray-500",children:g("staffLookup.loading")})]}),v&&!N&&(0,a.jsxs)("div",{className:"rounded-xl bg-red-50 p-6 text-center",children:[(0,a.jsx)(o,{className:"mx-auto mb-3 h-10 w-10 text-red-500"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-red-800",children:g("staffLookup.errors.".concat(v))}),(0,a.jsx)("p",{className:"mt-2 text-sm text-red-600",children:g("staffLookup.tryAgain")})]}),L&&!N&&!v&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"rounded-xl bg-white p-4 shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-blue-100",children:(0,a.jsx)(c,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:g("staffLookup.guestName")}),(0,a.jsx)("p",{className:"text-xl font-bold text-gray-900",children:L.guestName})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"rounded-xl bg-white p-4 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,a.jsx)(i,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm",children:g("staffLookup.room")})]}),(0,a.jsx)("p",{className:"mt-1 text-lg font-semibold text-gray-900",children:L.roomAssignment})]}),(0,a.jsxs)("div",{className:"rounded-xl bg-white p-4 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,a.jsx)(d,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm",children:g("staffLookup.nights")})]}),(0,a.jsxs)("p",{className:"mt-1 text-lg font-semibold text-gray-900",children:[L.nights," ",1===L.nights?g("stay.night"):g("stay.nights")]})]})]}),(0,a.jsxs)("div",{className:"rounded-xl bg-white p-4 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,a.jsx)(d,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm",children:g("staffLookup.dates")})]}),(0,a.jsxs)("p",{className:"mt-1 text-gray-900",children:[new Date(L.checkInDate).toLocaleDateString()," -"," ",new Date(L.checkOutDate).toLocaleDateString()]})]}),(L.etaWindow||L.etaMethod)&&(0,a.jsxs)("div",{className:"rounded-xl bg-blue-50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[(0,a.jsx)(u,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:g("staffLookup.eta")})]}),(0,a.jsxs)("p",{className:"mt-1 text-blue-900",children:[function(e){if(!e)return"-";let[t,s]=e.split(":").map(Number),a=s+30,r=t+Math.floor(a/60);return"".concat(e," - ").concat(String(r).padStart(2,"0"),":").concat(String(a%60).padStart(2,"0"))}(L.etaWindow),L.etaMethod&&" (".concat(g("eta.methods.".concat(L.etaMethod)),")")]})]}),(0,a.jsxs)("div",{className:"rounded-xl bg-green-50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,a.jsx)(m,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:g("staffLookup.payment")})]}),(0,a.jsxs)("div",{className:"mt-2 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-green-700",children:g("cash.cityTax.label")}),(0,a.jsxs)("span",{className:"font-semibold text-green-900",children:["€",L.cityTaxDue.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-green-700",children:g("cash.deposit.label")}),(0,a.jsxs)("span",{className:"font-semibold text-green-900",children:["€",L.depositDue.toFixed(2)]})]}),(0,a.jsx)("div",{className:"border-t border-green-200 pt-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-green-800",children:g("cash.total")}),(0,a.jsxs)("span",{className:"text-lg font-bold text-green-900",children:["€",(L.cityTaxDue+L.depositDue).toFixed(2)]})]})})]})]})]})]})}):null:(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsx)("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"})})}function j(){return(0,a.jsx)(h.Suspense,{fallback:(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsx)("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"})}),children:(0,a.jsx)(y,{})})}},3920:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(5682).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},4701:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(5682).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5682:(e,t,s)=>{"use strict";s.d(t,{A:()=>u});var a=s(7826);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),n=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:n,className:d="",children:u,iconNode:m,...x}=e;return(0,a.createElement)("svg",{ref:t,...i,width:r,height:r,stroke:s,strokeWidth:n?24*Number(l)/Number(r):l,className:o("lucide",d),...!u&&!c(x)&&{"aria-hidden":"true"},...x},[...m.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let s=(0,a.forwardRef)((s,l)=>{let{className:c,...i}=s;return(0,a.createElement)(d,{ref:l,iconNode:t,className:o("lucide-".concat(r(n(e))),"lucide-".concat(e),c),...i})});return s.displayName=n(e),s}},9528:(e,t,s)=>{"use strict";var a=s(3320);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},e=>{var t=t=>e(e.s=t);e.O(0,[956,889,358],()=>t(732)),_N_E=e.O()}]);