---
Type: Plan
Status: Active
Domain: UI
Workstream: Engineering
Created: 2026-02-10
Last-updated: 2026-02-10T18:30
Feature-Slug: prime-ui-theme-centralization
Deliverable-Type: code-change
Execution-Track: code
Primary-Execution-Skill: build-feature
Supporting-Skills: create-ui-component
Overall-confidence: 83%
Confidence-Method: min(Implementation,Approach,Impact); Overall weighted by Effort
Business-OS-Integration: off
---

# Prime UI + Theme Centralization Plan

## Summary
Prime has centralized UI/theme capability available (`@acme/design-system`, `@acme/ui`, `@themes/prime`) but app-level adoption is partial — only 11 of 51 component files import shared packages. DS lint enforcement is fully disabled at three layers (`.eslintrc.cjs`, `lint-wrapper.sh`, `eslint.config.mjs`). This plan migrates Prime component surfaces to centralized DS primitives directory-by-directory, enabling DS lint rules progressively per migrated slice, culminating in removal of the blanket bypass.

## Goals
- Replace raw HTML elements (`<button>`, `<input>`, `<textarea>`) with `@acme/design-system` primitives across Prime component surfaces.
- Replace raw Tailwind color/layout classes with theme-token-driven patterns.
- Re-enable DS lint rules progressively per migrated directory.
- Remove the blanket `offAllDsRules` bypass for Prime from `eslint.config.mjs`.
- Add tests for migrated surfaces and a DS lint regression guard.

## Non-goals
- Migrating shared packages (`@acme/ui`, `@acme/design-system`) — these are already centralized.
- Redesigning Prime UI/UX — migration preserves visual behavior.
- Migrating reception or other apps — separate plans.

## Constraints
- Prime theme tokens (`@themes/prime`) provide 13 token overrides (warm teal primary, amber accent, softer radii). Migrations must use these semantic tokens, not raw Tailwind colors.
- DS Card primitive provides `data-token="--color-bg"`, `bg-card shadow text-card-foreground rounded-xl border border-border-2`.
- DS Button API: `color` (default/primary/accent/success/info/warning/danger) + `tone` (solid/soft/outline/ghost/quiet), `size` (sm/md/lg), loading via `aria-busy`, `leadingIcon`/`trailingIcon`, `iconOnly`, `asChild`.

## Task Summary
| Task ID | Type | Description | Confidence | Effort | Status | Depends on | Blocks |
|---|---|---|---:|---:|---|---|---|
| TASK-01 | IMPLEMENT | Remove dead Prime UI wrappers + ineffective .eslintrc.cjs DS disables | 95% | S | Complete (2026-02-10) | - | - |
| TASK-02 | IMPLEMENT | Migrate homepage cards to DS primitives + enable DS rules | 84% | M | Complete (2026-02-10) | - | TASK-05 |
| TASK-03 | IMPLEMENT | Migrate arrival surface to DS primitives + enable DS rules | 85% | M | Complete (2026-02-10) | - | TASK-05 |
| TASK-04 | IMPLEMENT | Migrate pre-arrival surfaces to DS primitives + enable DS rules | 82% | M→L | Complete (2026-02-10) | - | TASK-05 |
| TASK-05 | CHECKPOINT | Horizon checkpoint — reassess remaining plan | 95% | S | Pending | TASK-02, TASK-03, TASK-04 | TASK-06, TASK-07, TASK-08, TASK-09 |
| TASK-06 | IMPLEMENT | Migrate portal onboarding flow to DS primitives + enable DS rules | 80% | L | Pending | TASK-05 | TASK-10 |
| TASK-07 | IMPLEMENT | Migrate onboarding steps to DS primitives + enable DS rules | 84% | M | Pending | TASK-05 | TASK-10 |
| TASK-08 | IMPLEMENT | Migrate routes + check-in surfaces to DS primitives + enable DS rules | 82% | M | Pending | TASK-05 | TASK-10 |
| TASK-09 | IMPLEMENT | Migrate remaining component surfaces to DS primitives + enable DS rules | 80% | M | Pending | TASK-05 | TASK-10 |
| TASK-10 | IMPLEMENT | Remove blanket DS bypass from eslint.config.mjs + lint-wrapper.sh | 82% | M | Pending | TASK-06, TASK-07, TASK-08, TASK-09 | TASK-11 |
| TASK-11 | IMPLEMENT | Add DS lint regression guard test | 88% | S | Pending | TASK-10 | - |

## Parallelism Guide

_Generated by `/sequence-plan`. Shows which tasks can run concurrently via subagents._

| Wave | Tasks | Prerequisites | Notes |
|------|-------|---------------|-------|
| 1 | TASK-01, TASK-02, TASK-03, TASK-04 | - | Max parallelism. TASK-01 is independent cleanup. TASK-02/03/04 share `eslint.config.mjs` (additive overrides — coordinate merge order) |
| 2 | TASK-05 | TASK-02, TASK-03, TASK-04 | CHECKPOINT: reassess approach before complex surfaces |
| 3 | TASK-06, TASK-07, TASK-08, TASK-09 | TASK-05 | Max parallelism. Coordinate `eslint.config.mjs` merge order |
| 4 | TASK-10 | TASK-06, TASK-07, TASK-08, TASK-09 | Removes blanket bypass after all migrations |
| 5 | TASK-11 | TASK-10 | Regression guard |

**Max parallelism:** 4 (Waves 1, 3) | **Critical path:** 5 waves | **Total tasks:** 11 (10 IMPLEMENT + 1 CHECKPOINT)

> **Note:** `eslint.config.mjs` is modified by tasks in Waves 1, 3, and 4. Each task adds a scoped override (non-conflicting globs), so parallel execution within a wave is safe as long as commits are coordinated (no conflicting line ranges).

---

## Task Details

### TASK-01: Remove dead Prime UI wrappers + ineffective .eslintrc.cjs DS disables
- **Type:** IMPLEMENT
- **Deliverable:** code-change
- **Execution-Skill:** build-feature
- **Affects:**
  - **Primary:** `apps/prime/src/components/ui/PrimeButton.tsx`, `apps/prime/src/components/ui/PrimeInput.tsx`, `apps/prime/src/components/ui/PrimeTextarea.tsx`, `apps/prime/.eslintrc.cjs`
- **Depends on:** -
- **Blocks:** -
- **Confidence:** 95%
- **Acceptance:**
  - PrimeButton.tsx, PrimeInput.tsx, PrimeTextarea.tsx deleted (confirmed zero imports).
  - `.eslintrc.cjs` DS rule disables removed (ineffective under flat config — only `extends: ['next/core-web-vitals']` remains).
  - `pnpm --filter @apps/prime lint` passes.
  - `pnpm --filter @apps/prime test` passes.
- **Validation contract:**
  - TC-01: No imports of PrimeButton/PrimeInput/PrimeTextarea remain in codebase
  - TC-02: `.eslintrc.cjs` has no `ds/` rule overrides
  - TC-03: Lint passes, tests pass

#### Build Completion (2026-02-10)
- **Status:** Complete
- **Commits:** 0d3e62099e
- **Execution cycle:**
  - Validation cases executed: TC-01, TC-02, TC-03
  - Cycles: 1 (red-green)
  - Initial validation: PASS
  - Final validation: PASS
- **Confidence reassessment:**
  - Original: 95%
  - Post-validation: 95%
  - Delta reason: validation confirmed — zero imports, clean lint, clean tests
- **Validation:**
  - Ran: `pnpm --filter @apps/prime lint` — PASS
  - Ran: `pnpm --filter @apps/prime test` — PASS (exit 0)
- **Documentation updated:** None required
- **Implementation notes:** Deleted PrimeButton.tsx, PrimeInput.tsx, PrimeTextarea.tsx. Removed DS rule disables from .eslintrc.cjs (kept `extends: ['next/core-web-vitals']`).

### TASK-02: Migrate homepage cards to DS primitives + enable DS rules
- **Type:** IMPLEMENT
- **Deliverable:** code-change — `apps/prime/src/components/homepage/cards/`
- **Execution-Skill:** build-feature
- **Affects:**
  - **Primary:** `apps/prime/src/components/homepage/cards/ServiceCard.tsx`, `apps/prime/src/components/homepage/cards/ServiceCard2.tsx`, `apps/prime/src/components/homepage/cards/TaskCard.tsx`
  - **Secondary:** `[readonly] packages/design-system/src/primitives/button.tsx`, `[readonly] packages/design-system/src/primitives/card.tsx`
  - **Primary (test):** new test file(s) in `apps/prime/src/components/homepage/cards/__tests__/`
  - **Primary (lint config):** `eslint.config.mjs` — add scoped DS rule re-enable for `apps/prime/src/components/homepage/**`
- **Depends on:** -
- **Blocks:** TASK-05
- **Confidence:** 84%
  - Implementation: 88% — DS Card primitive exists with clear API. Cards are self-contained components with no complex state.
  - Approach: 85% — Replacing raw elements with DS primitives follows established repo convention. Card components are good first migration targets.
  - Impact: 82% — Cards are rendered on homepage; visual behavior must remain consistent.
- **Acceptance:**
  - ServiceCard, ServiceCard2, TaskCard use DS Card primitive (no raw `<div>` with card styling).
  - Raw Tailwind color classes replaced with theme token classes.
  - DS rules enabled for `apps/prime/src/components/homepage/**` in eslint.config.mjs.
  - `pnpm exec eslint apps/prime/src/components/homepage/` passes with DS rules active.
  - New component tests verify card rendering and theme token usage.
- **Validation contract:**
  - TC-01: ServiceCard renders with DS Card primitive → data-token attribute present, no raw bg-white/border-gray
  - TC-02: ServiceCard title link uses theme token colors → no text-blue-* classes
  - TC-03: TaskCard completed/incomplete states use theme tokens → text-success not text-green, text-foreground not text-gray
  - TC-04: TaskCard checkmark uses text-success not text-green-*
  - TC-05: DS lint rules pass for homepage directory → `pnpm exec eslint apps/prime/src/components/homepage/` exits 0
  - **Validation type:** unit + lint
  - **Validation location:** `apps/prime/src/components/homepage/cards/__tests__/ServiceCard.test.tsx`, `apps/prime/src/components/homepage/cards/__tests__/TaskCard.test.tsx`
  - **Run:** `pnpm --filter @apps/prime test -- --testPathPattern homepage && pnpm exec eslint apps/prime/src/components/homepage/`

#### Build Completion (2026-02-10)
- **Status:** Complete
- **Commits:** 66c40b8ddd (card migration + tests), 5d72f624c6 (lint enablement + HomePage.tsx fix)
- **Execution cycle:**
  - Validation cases executed: TC-01 through TC-05
  - Cycles: 1 (red-green)
  - Initial validation: FAIL expected (tests failed before implementation)
  - Final validation: PASS
- **Confidence reassessment:**
  - Original: 84%
  - Post-validation: 88%
  - Delta reason: validation confirmed — cards had zero buttons (simpler than expected), only Card wrapping + color token replacement needed. Tests pass clean. Lint passes with 0 errors.
- **Validation:**
  - Ran: `pnpm --filter @apps/prime test -- --testPathPattern homepage` — PASS (23 tests, 3 suites)
  - Ran: `pnpm exec eslint apps/prime/src/components/homepage/` — PASS (0 errors, 26 warnings)
  - Ran: `pnpm --filter @apps/prime lint` — PASS
  - Typecheck: PASS
- **Documentation updated:** None required
- **Implementation notes:**
  - Replaced raw `<div>` wrappers with `<Card>` from `@acme/design-system/primitives` in all 3 card components.
  - Token replacements: `bg-white`/`border-gray-200`/`rounded-lg` → Card handles; `text-gray-800` → `text-foreground`; `text-blue-600` → `text-primary`; `hover:text-blue-800` → `hover:text-primary-hover`; `text-gray-600` → `text-muted-foreground`; `text-green-600` → `text-success`.
  - Additional fix: HomePage.tsx `text-gray-600` → `text-muted-foreground` (in loading state, within the homepage lint scope).
  - ESLint config: color/token rules at "error", remaining DS rules at "warn" for progressive hardening.
  - **Deviation from plan:** Plan TCs referenced "DS Button primitive" but homepage cards have zero `<button>` elements — migration was Card + token replacement only. Tests updated accordingly.

### TASK-03: Migrate arrival surface to DS primitives + enable DS rules
- **Type:** IMPLEMENT
- **Deliverable:** code-change — `apps/prime/src/components/arrival/`
- **Execution-Skill:** build-feature
- **Affects:**
  - **Primary:** `apps/prime/src/components/arrival/ArrivalHome.tsx`
  - **Secondary:** `[readonly] packages/ui/src/components/hospitality/ArrivalCodePanel.tsx`, `[readonly] packages/ui/src/components/hospitality/UtilityActionStrip.tsx`, `[readonly] packages/design-system/src/primitives/button.tsx`
  - **Primary (test):** `apps/prime/src/components/arrival/__tests__/ArrivalHome.tokens.test.tsx` (update)
  - **Primary (lint config):** `eslint.config.mjs` — add scoped DS rule re-enable for `apps/prime/src/components/arrival/**`
- **Depends on:** -
- **Blocks:** TASK-05
- **Confidence:** 85%
  - Implementation: 88% — ArrivalHome.tsx is a single component with clear token replacement patterns.
  - Approach: 85% — Same migration pattern as TASK-02 homepage cards.
  - Impact: 82% — Arrival surface is the first thing guests see after check-in code entry.
- **Acceptance:**
  - ArrivalHome.tsx uses DS primitives and theme tokens.
  - Raw Tailwind color classes replaced with theme token classes.
  - DS rules enabled for `apps/prime/src/components/arrival/**` in eslint.config.mjs.
  - Lint passes for arrival directory.
  - Tests verify token usage.
- **Validation contract:**
  - TC-01: ArrivalHome renders with DS primitives and theme tokens
  - TC-02: No raw palette classes remain in arrival components
  - TC-03: DS lint rules pass for arrival directory
  - **Run:** `pnpm --filter @apps/prime test -- --testPathPattern arrival && pnpm exec eslint apps/prime/src/components/arrival/`
- **Rollout / rollback:**
  - Rollout: Single commit with migration + lint scope.
  - Rollback: `git revert <commit>`.
- **Documentation impact:** None

#### Build Completion (2026-02-10)
- **Status:** Complete
- **Commits:** 0926519eb5
- **Execution cycle:**
  - Validation cases executed: TC-01 through TC-05 (ArrivalHome: green/amber/blue/gray/red palette elimination; KeycardStatus: success/warning/info token verification)
  - Cycles: 1 (red-green)
  - Initial validation: FAIL expected (8 tests failed — raw color classes present)
  - Final validation: PASS
- **Confidence reassessment:**
  - Original: 85%
  - Post-validation: 90%
  - Delta reason: validation confirmed — semantic token mapping (bg-success-soft/text-success-foreground etc.) covers all arrival status patterns cleanly. KeycardStatus migration trivial (3 states × 3 replacements).
- **Validation:**
  - Ran: `pnpm --filter @apps/prime test -- --testPathPattern "components/arrival"` — PASS (20 tests, 6 suites)
  - Ran: `pnpm exec eslint apps/prime/src/components/arrival/` — PASS (0 errors, 4 warnings)
  - Typecheck: PASS
- **Documentation updated:** None required
- **Implementation notes:**
  - ArrivalHome.tsx: ~48 raw color class replacements across 5 semantic groups: success (green→bg-success-soft/text-success-foreground), warning (amber→bg-warning-soft/text-warning-foreground), info (blue→bg-info-soft/text-info-foreground), danger (red→bg-danger-soft/text-danger-foreground), neutral (gray→bg-muted/text-foreground/text-muted-foreground).
  - Refresh button: bg-blue-600→bg-primary, text-white→text-primary-foreground, hover:bg-blue-700→hover:bg-primary/90.
  - Gradient (from-blue-50 to-indigo-50) replaced with single bg-info-soft token.
  - KeycardStatus.tsx: 3 state branches (issued/lost/pending) migrated to semantic tokens.
  - **Scope addition:** KeycardStatus.tsx not in original Affects but in same directory — migrated to pass DS lint enablement.

### TASK-04: Migrate pre-arrival surfaces to DS primitives + enable DS rules
- **Type:** IMPLEMENT
- **Deliverable:** code-change — `apps/prime/src/components/pre-arrival/`
- **Execution-Skill:** build-feature
- **Affects:**
  - **Primary:** `apps/prime/src/components/pre-arrival/ReadinessDashboard.tsx`, `apps/prime/src/components/pre-arrival/CashPrep.tsx`, `apps/prime/src/components/pre-arrival/EtaConfirmation.tsx`
  - **Primary (test):** test files in `apps/prime/src/components/pre-arrival/__tests__/`
  - **Primary (lint config):** `eslint.config.mjs` — add scoped DS rule re-enable for `apps/prime/src/components/pre-arrival/**`
- **Depends on:** -
- **Blocks:** TASK-05
- **Confidence:** 82%
  - Implementation: 85% — ReadinessDashboard already partially centralized.
  - Approach: 84% — Same migration pattern as TASK-02/03.
  - Impact: 82% — Pre-arrival surfaces handle guest preparation flow.
- **Acceptance:**
  - ReadinessDashboard, CashPrep, EtaConfirmation use DS primitives and theme tokens.
  - DS rules enabled for pre-arrival directory.
  - Lint and tests pass.
- **Validation contract:**
  - TC-01: Pre-arrival components render with DS primitives and theme tokens
  - TC-02: No raw palette classes remain
  - TC-03: DS lint rules pass for pre-arrival directory
  - **Run:** `pnpm --filter @apps/prime test -- --testPathPattern pre-arrival && pnpm exec eslint apps/prime/src/components/pre-arrival/`
- **Rollout / rollback:**
  - Rollout: Single commit with migration + lint scope.
  - Rollback: `git revert <commit>`.
- **Documentation impact:** None
- **Notes / references:**
  - Fact-find: Pre-arrival directory has 6 component files + multiple test files. ReadinessDashboard already partially centralized.

#### Build Completion (2026-02-10)
- **Status:** Complete
- **Commits:** 04513e4016
- **Execution cycle:**
  - Validation cases executed: TC-01 through TC-07 (15 test cases covering all 7 components)
  - Cycles: 1 (red-green)
  - Initial validation: FAIL expected (15 tests failed — raw palette classes present)
  - Final validation: PASS
- **Confidence reassessment:**
  - Original: 82%
  - Post-validation: 88%
  - Delta reason: validation confirmed — all 7 components migrated cleanly. SVG stroke migration solved via stroke="currentColor" + text-* tokens. NextActionCard gradients replaced with solid semantic bg tokens + matching fg tokens.
- **Validation:**
  - Ran: `pnpm --filter @apps/prime test -- --testPathPattern "components/pre-arrival"` — PASS (26 tests, 7 suites)
  - Ran: `pnpm exec eslint apps/prime/src/components/pre-arrival/` — PASS (0 errors, 6 warnings)
  - Ran: `pnpm --filter @apps/prime lint` — PASS (0 errors, 2 warnings)
  - Typecheck: PASS
- **Documentation updated:** None required
- **Implementation notes:**
  - **Scope expansion:** Plan listed 3 files (M effort) but directory has 7 components requiring migration. Actual effort L. All migrated in single cycle.
  - AddToCalendarButton: bg-card, border-border, text-foreground, hover:bg-muted. Removed dark: variants (DS handles via tokens).
  - CashPrep: gradient→bg-success-soft, checkbox icons text-success/text-muted-foreground, total bar bg-foreground/text-background, info note bg-info-soft, conditional confirm button bg-success/bg-primary.
  - ChecklistItem: 3-state conditional classes (completed→success-soft, interactive→card/border, default→muted/border).
  - EtaConfirmation: selected/unselected buttons bg-primary/bg-muted, late warning bg-warning-soft, textarea focus:border-primary/30, disabled button bg-muted.
  - NextActionCard: replaced 7 gradient variants with solid semantic bg tokens (bg-success, bg-primary, bg-accent, bg-warning, bg-info, bg-danger, bg-muted) + matching fg tokens. Decorative overlays bg-background/10.
  - ReadinessDashboard: header badge bg-info-soft, check-in card bg-info-soft, arrival day badge bg-success-soft, completion banner bg-success-soft, preferences link border-border, stay info bg-muted.
  - ReadinessScore: SVG stroke migration — added stroke="currentColor" to progress circle, changed stroke-* tokens to text-* tokens (text-success, text-info, text-warning, text-muted-foreground). Background circle text-muted.

### TASK-05: Horizon checkpoint — reassess remaining plan
- **Type:** CHECKPOINT
- **Depends on:** TASK-02, TASK-03, TASK-04
- **Blocks:** TASK-06, TASK-07, TASK-08, TASK-09
- **Confidence:** 95%
- **Acceptance:**
  - Run `/re-plan` on all tasks after this checkpoint.
  - Reassess remaining task confidence using evidence from completed migrations.
  - Validate that the migration pattern from Wave 1 scales to complex surfaces (portal, onboarding).
- **Horizon assumptions to validate:**
  - DS Button `color`+`tone` API covers all Prime button patterns (confirmed by TASK-02: no buttons in cards, need confirmation from TASK-03/04).
  - DS Card primitive handles all Prime card patterns.
  - Progressive lint enablement (per-directory overrides in eslint.config.mjs) is sustainable.
  - Test coverage approach (theme token assertions) is sufficient for migration verification.

### TASK-06: Migrate portal onboarding flow to DS primitives + enable DS rules
- **Type:** IMPLEMENT
- **Deliverable:** code-change — `apps/prime/src/components/portal/`
- **Execution-Skill:** build-feature
- **Effort:** L
- **Affects:**
  - **Primary:** `apps/prime/src/components/portal/GuidedOnboardingFlow.tsx`
  - **Primary (test):** `apps/prime/src/components/portal/__tests__/GuidedOnboardingFlow.ds-migration.test.tsx` (new — stubs already written)
  - **Primary (lint config):** `eslint.config.mjs` — add scoped DS rule re-enable for `apps/prime/src/components/portal/**`
- **Depends on:** TASK-05
- **Blocks:** TASK-10
- **Confidence:** 80%
  - Implementation: 82% — GuidedOnboardingFlow has 13 buttons; high density but clear migration pattern.
  - Approach: 80% — Need to verify DS Button covers all interaction patterns (toggle, confirmation, navigation).
  - Impact: 78% — Core guest onboarding flow; must preserve step transitions and skip path.
- **Acceptance:**
  - GuidedOnboardingFlow uses DS Button for all 13 buttons.
  - Toggle/selection buttons use `aria-pressed`.
  - Confirmation buttons use loading state (`aria-busy`).
  - DS rules enabled for portal directory.
  - All existing GuidedOnboardingFlow tests still pass.
  - New DS migration tests pass.
- **Validation contract:**
  - TC-01: Step navigation buttons use DS Button with correct tone (forward=primary/solid, back=outline)
  - TC-02: Toggle/selection buttons use DS Button with aria-pressed state
  - TC-03: Confirmation buttons use DS Button with loading state (aria-busy during async)
  - TC-04: Checkbox inputs use DS Checkbox primitive with accessible label
  - TC-05: Step transitions remain behaviorally identical after migration
  - TC-06: Skip path works with migrated buttons
  - TC-07: No raw palette classes remain (all use theme tokens)
  - **Run:** `pnpm --filter @apps/prime test -- --testPathPattern "GuidedOnboardingFlow" && pnpm exec eslint apps/prime/src/components/portal/`
- **Planning validation:**
  - Tests run: existing GuidedOnboardingFlow.test.tsx covers step transitions, persistence, skip path
  - Test stubs written: `apps/prime/src/components/portal/__tests__/GuidedOnboardingFlow.ds-migration.test.tsx`
  - Unexpected findings: 13 buttons is high density for a single component; may need to extract sub-components during refactor phase
- **What would make this ≥90%:**
  - Complete Wave 1 migrations (TASK-02–TASK-04) to calibrate DS Button migration effort per button.
  - Verify DS Checkbox renders correctly in Prime theme context.
- **Rollout / rollback:**
  - Rollout: Single commit with migration + lint scope. Extra review attention on step flow behavior.
  - Rollback: `git revert <commit>`.
- **Documentation impact:** None

### TASK-07: Migrate onboarding steps to DS primitives + enable DS rules
- **Type:** IMPLEMENT
- **Deliverable:** code-change — `apps/prime/src/components/onboarding/`
- **Execution-Skill:** build-feature
- **Affects:**
  - **Primary:** Onboarding step component files in `apps/prime/src/components/onboarding/`
  - **Primary (test):** test files in `apps/prime/src/components/onboarding/__tests__/`
  - **Primary (lint config):** `eslint.config.mjs` — add scoped DS rule re-enable for `apps/prime/src/components/onboarding/**`
- **Depends on:** TASK-05
- **Blocks:** TASK-10
- **Confidence:** 84%
- **Acceptance:**
  - Onboarding step components use DS primitives and theme tokens.
  - DS rules enabled for onboarding directory.
  - Lint and tests pass.
- **Validation contract:**
  - TC-01: Onboarding components render with DS primitives and theme tokens
  - TC-02: No raw palette classes remain
  - TC-03: DS lint rules pass for onboarding directory
- **Rollout / rollback:**
  - Rollout: Single commit with migration + lint scope.
  - Rollback: `git revert <commit>`.
- **Documentation impact:** None

### TASK-08: Migrate routes + check-in surfaces to DS primitives + enable DS rules
- **Type:** IMPLEMENT
- **Deliverable:** code-change — route-level pages in `apps/prime/src/app/`
- **Execution-Skill:** build-feature
- **Affects:**
  - **Primary:** Route components with raw HTML elements/colors
  - **Primary (lint config):** `eslint.config.mjs` — add scoped DS rule re-enable for migrated route paths
- **Depends on:** TASK-05
- **Blocks:** TASK-10
- **Confidence:** 82%
- **Acceptance:**
  - Route-level pages use DS primitives and theme tokens.
  - DS rules enabled for migrated route paths.
  - Lint and tests pass.
- **Validation contract:**
  - TC-01: Route components render with DS primitives and theme tokens
  - TC-02: No raw palette classes remain in migrated routes
  - TC-03: DS lint rules pass for migrated route directories
- **Rollout / rollback:**
  - Rollout: Single commit with migration + lint scope.
  - Rollback: `git revert <commit>`.
- **Documentation impact:** None

### TASK-09: Migrate remaining component surfaces to DS primitives + enable DS rules
- **Type:** IMPLEMENT
- **Deliverable:** code-change — remaining components not covered by TASK-02–08
- **Execution-Skill:** build-feature
- **Affects:**
  - **Primary:** Remaining component files with raw HTML elements/colors
  - **Primary (lint config):** `eslint.config.mjs` — add scoped DS rule re-enable for remaining component paths
- **Depends on:** TASK-05
- **Blocks:** TASK-10
- **Confidence:** 80%
- **Acceptance:**
  - All remaining component surfaces use DS primitives and theme tokens.
  - DS rules enabled for all remaining component directories.
  - Lint and tests pass.
- **Validation contract:**
  - TC-01: Remaining components render with DS primitives and theme tokens
  - TC-02: No raw palette classes remain
  - TC-03: DS lint rules pass for remaining directories
- **Rollout / rollback:**
  - Rollout: Single commit per directory group.
  - Rollback: `git revert <commit>`.
- **Documentation impact:** None

### TASK-10: Remove blanket DS bypass from eslint.config.mjs + lint-wrapper.sh
- **Type:** IMPLEMENT
- **Deliverable:** code-change — lint configuration
- **Execution-Skill:** build-feature
- **Affects:**
  - **Primary:** `eslint.config.mjs`, `apps/prime/scripts/lint-wrapper.sh`
  - **Secondary:** All Prime component files (must pass full DS lint)
- **Depends on:** TASK-06, TASK-07, TASK-08, TASK-09
- **Blocks:** TASK-11
- **Confidence:** 82%
  - Implementation: 85% — Straightforward config removal.
  - Approach: 84% — Removing bypass is the natural conclusion of progressive migration.
  - Impact: 82% — This is the "point of no return" for DS enforcement in Prime. All component files must pass DS lint. Any remaining violations need scoped exceptions.
- **Acceptance:**
  - `offAllDsRules` override for `apps/prime/**` removed from eslint.config.mjs (complexity/max-lines override may remain separately).
  - DS_OVERRIDES array removed from lint-wrapper.sh.
  - Per-directory re-enable overrides from TASK-02–09 removed (no longer needed without blanket disable).
  - `pnpm exec eslint apps/prime/src/` passes with full DS rules active.
  - `pnpm --filter @apps/prime lint` passes (lint-wrapper.sh no longer injects DS overrides).
  - Any remaining DS violations are documented as scoped exceptions with tracking tickets.
- **Validation contract:**
  - TC-01: Full DS lint pass on Prime → `pnpm exec eslint apps/prime/src/` exits 0 with no DS rule exceptions
  - TC-02: No `offAllDsRules` reference remains in Prime-targeting config blocks
  - TC-03: `pnpm --filter @apps/prime lint` passes end-to-end
  - TC-04: Per-directory re-enable blocks removed (cleanup)
- **Rollout / rollback:**
  - Rollout: Single commit removing bypass + per-directory overrides. High-confidence since all directories already passing.
  - Rollback: `git revert <commit>` restores bypass.
- **Documentation impact:** `apps/prime/docs/CONTRIBUTING.md` — update DS enforcement section.

### TASK-11: Add DS lint regression guard test
- **Type:** IMPLEMENT
- **Deliverable:** code-change — test
- **Execution-Skill:** build-feature
- **Affects:**
  - **Primary:** New test file for DS lint regression guard
- **Depends on:** TASK-10
- **Blocks:** -
- **Confidence:** 88%
- **Acceptance:**
  - New test verifies that DS lint rules are active for Prime app (no blanket bypass).
  - Test fails if `offAllDsRules` is re-added for Prime in eslint.config.mjs.
  - Test passes in CI.
- **Validation contract:**
  - TC-01: Guard test passes with DS rules active
  - TC-02: Guard test would fail if blanket bypass re-introduced (manually verified logic)
- **Rollout / rollback:**
  - Rollout: Single commit adding test.
  - Rollback: `git revert <commit>`.
- **Documentation impact:** None

## Risks & Mitigations
- **Visual regression from DS primitive adoption:** Mitigate by testing in Prime theme context; DS primitives read theme tokens automatically. PR review with visual comparison for each migration slice.
- **Button behavior changes after migration:** Mitigate by preserving all event handlers and aria attributes. Existing integration tests catch behavioral regressions.
- **Lint rule false positives after re-enablement:** Mitigate by enabling per-directory first (TASK-02–09) before removing blanket bypass (TASK-10). Scoped exceptions documented where rules can't be satisfied.
- **GuidedOnboardingFlow complexity (13 buttons):** Mitigate by checkpoint gate (TASK-05) after first wave; may split into sub-components during refactor phase.
- **Pre-existing test timeouts (MealOrderPage, find-my-stay):** Not related to this work but noted. Migration should not increase test duration.

## Observability
- Logging: No new logging required (UI-only changes).
- Metrics: DS lint warning/error counts trackable via CI output.
- Monitoring: Visual regression caught by PR review + existing test suites.
