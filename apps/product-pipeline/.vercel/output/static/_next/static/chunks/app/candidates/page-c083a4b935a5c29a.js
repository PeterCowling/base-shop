(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1513],{117:(e,a,t)=>{Promise.resolve().then(t.bind(t,6223)),Promise.resolve().then(t.bind(t,6423)),Promise.resolve().then(t.bind(t,368)),Promise.resolve().then(t.bind(t,8634)),Promise.resolve().then(t.bind(t,5016)),Promise.resolve().then(t.bind(t,9602)),Promise.resolve().then(t.bind(t,9633)),Promise.resolve().then(t.bind(t,1875)),Promise.resolve().then(t.bind(t,6884)),Promise.resolve().then(t.bind(t,5216)),Promise.resolve().then(t.bind(t,124)),Promise.resolve().then(t.bind(t,4274))},5480:(e,a,t)=>{"use strict";function n(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-GB",t=Number(e)/100;return Number.isFinite(t)?new Intl.NumberFormat(a,{style:"currency",currency:"EUR",maximumFractionDigits:0}).format(t):"-"}function s(e){return null==e||Number.isNaN(e)?"-":new Intl.NumberFormat("en-GB",{maximumFractionDigits:2}).format(e)}function r(e){return null==e||Number.isNaN(e)?"-":new Intl.NumberFormat("en-GB",{style:"percent",maximumFractionDigits:1}).format(e)}t.d(a,{ZV:()=>s,l9:()=>r,vv:()=>n})},6223:(e,a,t)=>{"use strict";t.d(a,{default:()=>d});var n=t(6586),s=t(55),r=t.n(s),l=t(7826),i=t(5480),o=t(8902);function d(e){let{strings:a}=e,[t,s]=(0,l.useState)([]),[d,c]=(0,l.useState)(!0),[u,m]=(0,l.useState)([]),[b,x]=(0,l.useState)(!1),[p,g]=(0,l.useState)(null),h=(0,l.useCallback)(async()=>{c(!0);try{let e=await fetch("/api/candidates?limit=50");if(!e.ok)return;let a=await e.json();if(a.ok&&Array.isArray(a.candidates)){s(a.candidates);let e=new Set(a.candidates.map(e=>e.id));m(a=>a.filter(a=>e.has(a)))}}catch(e){console.error(e)}finally{c(!1)}},[]);(0,l.useEffect)(()=>{h()},[h]);let f=(0,l.useMemo)(()=>new Set(u),[u]),y=t.length>0&&t.every(e=>f.has(e.id)),v=(0,l.useCallback)(()=>{m(e=>{if(0===t.length)return e;let a=t.map(e=>e.id);return a.every(a=>e.includes(a))?[]:a})},[t]),N=(0,l.useCallback)(e=>{m(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])},[]),k=(0,l.useMemo)(()=>{if(0===u.length)return null;let e=new URLSearchParams;return e.set("ids",u.join(",")),"/api/exports/candidates?".concat(e.toString())},[u]),j=(0,l.useCallback)(()=>{k&&window.location.assign(k)},[k]),w=(0,l.useCallback)(async()=>{if(0===u.length)return void g({tone:"error",text:a.bulk.noneSelected});x(!0),g({tone:"info",text:a.bulk.running});let e=0,t=0;for(let n=0;n<u.length;n+=1){let s=u[n];if(s){g({tone:"info",text:a.bulk.progress.replace("{current}",String(n+1)).replace("{total}",String(u.length))});try{let a=await fetch("/api/stages/k/compose",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidateId:s})});if(!a.ok){t+=1;continue}let n=await a.json();if(!n.ok||!n.input||!(await fetch("/api/stages/k/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidateId:s,input:n.input,scenario:n.scenario,requestedBy:"bulk_run"})})).ok){t+=1;continue}e+=1}catch(e){console.error(e),t+=1}}}let n=a.bulk.complete.replace("{success}",String(e)).replace("{failed}",String(t));g({tone:t>0?"error":"success",text:n}),x(!1),await h()},[h,u,a.bulk]),S=(0,l.useMemo)(()=>0===t.length?t:[...t].sort((e,a)=>{var t,n,s,r,l,i,o,d;let c=null!=(i=null!=(l=null==(t=e.stageR.summary)?void 0:t.rankScore)?l:null==(n=e.stageK.summary)?void 0:n.annualizedCapitalReturnRate)?i:-1/0;return(null!=(d=null!=(o=null==(s=a.stageR.summary)?void 0:s.rankScore)?o:null==(r=a.stageK.summary)?void 0:r.annualizedCapitalReturnRate)?d:-1/0)-c}),[t]);return(0,n.jsxs)("section",{className:"pp-card p-6",children:[(0,n.jsxs)(o.d2,{justify:"between",alignY:"center",className:"gap-4",children:[(0,n.jsxs)(o.BJ,{gap:2,children:[(0,n.jsx)("span",{className:"text-xs uppercase tracking-widest text-foreground/60",children:a.rankedLabel}),(0,n.jsx)("h2",{className:"text-xl font-semibold tracking-tight",children:a.rankedTitle}),p?(0,n.jsx)("span",{className:"text-xs ".concat("error"===p.tone?"text-red-600":"success"===p.tone?"text-emerald-600":"text-foreground/60"),children:p.text}):null]}),(0,n.jsxs)(o.d2,{gap:3,alignY:"center",children:[(0,n.jsxs)("label",{className:"flex items-center gap-2 text-xs uppercase tracking-widest text-foreground/60",children:[(0,n.jsx)("input",{type:"checkbox","aria-label":a.selectAllLabel,checked:y,onChange:v}),a.selectAllLabel]}),(0,n.jsx)("button",{className:"min-h-12 min-w-12 rounded-full border border-border-2 px-4 py-2 text-sm disabled:cursor-not-allowed disabled:opacity-60",onClick:j,disabled:!k,type:"button",children:a.exportCsvLabel}),(0,n.jsx)("button",{className:"min-h-12 min-w-12 rounded-full bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground disabled:cursor-not-allowed disabled:opacity-60",onClick:()=>void w(),disabled:b||0===u.length,type:"button",children:a.runStageKLabel})]})]}),(0,n.jsx)(o.BJ,{gap:4,className:"mt-6",children:d?Array.from({length:3}).map((e,a)=>(0,n.jsxs)("div",{className:"rounded-3xl border border-border-1 bg-surface-2 p-4",children:[(0,n.jsx)("div",{className:"h-4 w-24 rounded-full bg-foreground/10"}),(0,n.jsx)("div",{className:"mt-3 h-5 w-48 rounded-full bg-foreground/10"}),(0,n.jsx)("div",{className:"mt-4 h-3 w-32 rounded-full bg-foreground/10"}),(0,n.jsx)("div",{className:"mt-6 h-8 w-full rounded-2xl bg-foreground/10"})]},"skeleton-".concat(a))):S.map(e=>{var t,s,l,d,c,u,m,b,x,p,g,h,y;let v=null!=(g=null!=(p=null==(t=e.lead)?void 0:t.title)?p:null==(s=e.lead)?void 0:s.url)?g:a.notAvailable,k=null!=(h=e.stageStatus)?h:a.notAvailable,j=(null==(l=e.stageK.summary)?void 0:l.returnBand)?e.stageK.summary.returnBand.toUpperCase():a.notAvailable,w=a.notAvailable;if(null==(d=e.stageK.summary)?void 0:d.peakCashOutlayCents)try{w=(0,i.vv)(BigInt(e.stageK.summary.peakCashOutlayCents))}catch(e){w=a.notAvailable}let S=(null==(c=e.stageK.summary)?void 0:c.paybackDay)!==null&&(null==(u=e.stageK.summary)?void 0:u.paybackDay)!==void 0?String(e.stageK.summary.paybackDay):a.notAvailable,C=(null==(m=e.stageR.summary)?void 0:m.riskBand)?e.stageR.summary.riskBand.toUpperCase():a.notAvailable,A=(null==(b=e.stageR.summary)?void 0:b.effortBand)?e.stageR.summary.effortBand.toUpperCase():a.notAvailable,B=null!=(y=null==(x=e.stageR.summary)?void 0:x.nextAction)?y:null,R="ADVANCE"===B?a.nextActions.advance:"REVIEW_RISK"===B?a.nextActions.reviewRisk:"REVIEW_EFFORT"===B?a.nextActions.reviewEffort:"NEED_STAGE_K"===B?a.nextActions.needStageK:a.notAvailable;return(0,n.jsxs)("div",{className:"rounded-3xl border border-border-1 bg-surface-2 p-4",children:[(0,n.jsxs)(o.d2,{justify:"between",alignY:"center",className:"gap-4",children:[(0,n.jsxs)(o.BJ,{gap:1,children:[(0,n.jsx)("span",{className:"text-xs text-foreground/60",children:e.id}),(0,n.jsx)(r(),{href:"/candidates/".concat(e.id),className:"text-lg font-semibold hover:underline",children:v}),(0,n.jsxs)("span",{className:"text-xs text-foreground/60",children:[a.stageLabel,": ",k]})]}),(0,n.jsxs)(o.d2,{gap:4,alignY:"center",children:[(0,n.jsxs)(o.cV,{gap:4,alignY:"center",className:"text-sm",children:[(0,n.jsxs)(o.BJ,{gap:1,children:[(0,n.jsx)("span",{className:"text-xs text-foreground/60",children:a.returnBandLabel}),(0,n.jsx)("span",{className:"font-semibold",children:j})]}),(0,n.jsxs)(o.BJ,{gap:1,children:[(0,n.jsx)("span",{className:"text-xs text-foreground/60",children:a.peakCashLabel}),(0,n.jsx)("span",{className:"font-semibold",children:w})]}),(0,n.jsxs)(o.BJ,{gap:1,children:[(0,n.jsx)("span",{className:"text-xs text-foreground/60",children:a.paybackLabel}),(0,n.jsx)("span",{className:"font-semibold",children:S})]})]}),(0,n.jsx)("input",{type:"checkbox","aria-label":a.selectLabel,checked:f.has(e.id),onChange:()=>N(e.id)})]})]}),(0,n.jsxs)(o.cV,{gap:3,className:"mt-4 text-xs",children:[(0,n.jsxs)("span",{className:"rounded-full border border-border-2 px-3 py-1",children:[a.riskLabel,": ",C]}),(0,n.jsxs)("span",{className:"rounded-full border border-border-2 px-3 py-1",children:[a.effortLabel,": ",A]}),(0,n.jsxs)("span",{className:"rounded-full border border-border-2 px-3 py-1",children:[a.nextLabel,": ",R]})]})]},e.id)})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[2827,9683,7106,55,4668,8902,9956,2459,7358],()=>a(117)),_N_E=e.O()}]);