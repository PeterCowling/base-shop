(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[148],{905:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(6586),n=r(7826),i=r(65),o=r(7862);let s=n.memo(function(e){let{amount:t,currency:r}=e,s=(0,i.Y)(),l=(0,n.useMemo)(()=>{var e;return e=(0,o.Tl)(s),new Intl.NumberFormat(e,{style:"currency",currency:r,currencyDisplay:"narrowSymbol"}).format(t/100)},[t,r,s]);return(0,a.jsx)("span",{children:l})})},4625:(e,t,r)=>{"use strict";r.d(t,{default:()=>m});var a=r(6586),n=r(7826),i=r(5876),o=r(6024),s=r(6233),l=r(6157),c=r(905),u=r(6662);let d=n.memo(function(e){let{onClick:t,disabled:r,isLoading:i,label:o,loadingLabel:s}=e,l=(0,n.useMemo)(()=>i?s:o,[i,o,s]);return(0,a.jsx)(u.A,{type:"button",onClick:t,disabled:r||i,children:l})});var f=r(65);let m=n.memo(function(e){let{products:t}=e,r=(0,i.c3)(),u=(0,f.Y)(),{items:m,subtotal:y,currency:v}=(0,o._)(),[p,h]=(0,n.useState)(!1),[b,x]=(0,n.useState)(null),k=(0,n.useMemo)(()=>(0,s.$)(m,t),[m,t]),w=m.length>0,j=(0,n.useMemo)(()=>({items:m.map(e=>({variantId:e.variantId,quantity:e.quantity})),locale:u}),[m,u]),I=(0,n.useCallback)(async()=>{if(w){x(null),h(!0);try{let e=await (0,l.f)(j);window.location.href=e.url}catch(e){x(r("checkout.error")),h(!1)}}},[w,j,r]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"surface rounded-3xl border border-border-1 p-5",children:[(0,a.jsx)("div",{className:"text-xs font-semibold uppercase tracking-widest text-muted-foreground",children:r("checkout.review")}),(0,a.jsxs)("div",{className:"mt-4 space-y-3 text-sm",children:[k.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:r(e.product.name)}),(0,a.jsxs)("div",{className:"text-muted-foreground",children:[r("size.".concat(e.variant.size))," / ",r("color.".concat(e.variant.color))]})]}),(0,a.jsxs)("div",{className:"text-end",children:[(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[r("checkout.qty")," ",e.item.quantity]}),(0,a.jsx)("div",{className:"font-semibold",children:(0,a.jsx)(c.A,{amount:e.variant.price*e.item.quantity,currency:e.variant.currency})})]})]},e.item.variantId)),(0,a.jsxs)("div",{className:"flex items-center justify-between border-t border-border-1 pt-3 text-base font-semibold",children:[(0,a.jsx)("span",{children:r("checkout.total")}),(0,a.jsx)(c.A,{amount:y,currency:v})]})]})]}),b?(0,a.jsx)("div",{className:"rounded-2xl border border-red-200 bg-red-50 p-4 text-sm text-red-700",children:b}):null,(0,a.jsx)(d,{onClick:I,disabled:!w,isLoading:p,label:r("checkout.pay"),loadingLabel:r("checkout.loading")})]})})},6024:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>y,_:()=>v});var a=r(6586),n=r(7826),i=r(7718);let o={items:[],updatedAt:0},s=e=>({items:e,updatedAt:Date.now()}),l=e=>e.map(e=>({variantId:e.variantId,quantity:(0,i.pE)(e.quantity)})).filter(e=>e.variantId&&e.quantity>=i.yY);function c(e,t){switch(t.type){case"hydrate":return s(l(t.payload));case"add":{let{variantId:r,quantity:a}=t.payload,n=[...e.items],o=n.findIndex(e=>e.variantId===r),l=(0,i.pE)(a);if(o>=0){let e=n[o];if(!e)return s(n);n[o]={variantId:e.variantId,quantity:(0,i.pE)(e.quantity+l)}}else n.push({variantId:r,quantity:l});return s(n)}case"remove":return s(e.items.filter(e=>e.variantId!==t.payload.variantId));case"setQuantity":return s(l(e.items.map(e=>e.variantId!==t.payload.variantId?e:{...e,quantity:(0,i.pE)(t.payload.quantity)})));case"clear":return s([]);default:return e}}let u="cochlearfit:cart",d=e=>!!e&&"object"==typeof e&&"string"==typeof e.variantId&&"number"==typeof e.quantity&&e.quantity>=i.yY;var f=r(6233);let m=(0,n.createContext)(null);function y(e){let{children:t}=e,[r,s]=(0,n.useReducer)(c,o),l=(0,n.useMemo)(()=>(0,f.m)(r),[r]),y=(0,n.useCallback)((e,t)=>{s({type:"add",payload:{variantId:e,quantity:t}})},[]),v=(0,n.useCallback)(e=>{s({type:"remove",payload:{variantId:e}})},[]),p=(0,n.useCallback)((e,t)=>{s({type:"setQuantity",payload:{variantId:e,quantity:t}})},[]),h=(0,n.useCallback)(()=>{s({type:"clear"})},[]),b=(0,n.useCallback)(()=>{let e=function(){let e=window.localStorage.getItem(u);if(!e)return null;try{let t=JSON.parse(e);if(!t||1!==t.version||!Array.isArray(t.items))return null;return t.items.filter(d).map(e=>({variantId:e.variantId,quantity:(0,i.pE)(e.quantity)}))}catch(e){return null}}();e&&e.length>0&&s({type:"hydrate",payload:e})},[]);(0,n.useEffect)(()=>{b()},[b]),(0,n.useEffect)(()=>{let e={version:1,items:r.items.map(e=>({variantId:e.variantId,quantity:(0,i.pE)(e.quantity)}))};window.localStorage.setItem(u,JSON.stringify(e))},[r.items]);let x=(0,n.useMemo)(()=>({items:r.items,itemCount:l.itemCount,subtotal:l.subtotal,currency:l.currency,addItem:y,removeItem:v,setQuantity:p,clear:h}),[y,h,v,p,r.items,l]);return(0,a.jsx)(m.Provider,{value:x,children:t})}function v(){let e=(0,n.useContext)(m);if(!e)throw Error("useCart must be used within CartProvider");return e}},6157:(e,t,r)=>{"use strict";var a;r.d(t,{f:()=>o,J:()=>s});let n=null!=(a=r(7811).env.NEXT_PUBLIC_API_BASE_URL)?a:"";function i(e){return"".concat(n).concat(e)}async function o(e){let t=await fetch(i("/api/checkout/session"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create checkout session");return await t.json()}async function s(e){let t=await fetch(i("/api/checkout/session/".concat(e)),{method:"GET"});if(!t.ok)throw Error("Failed to fetch checkout session");return await t.json()}},6233:(e,t,r)=>{"use strict";r.d(t,{$:()=>i,m:()=>n});var a=r(7157);function n(e){let t=0,r=0,n="USD";for(let i of e.items){let e=(0,a._s)(i.variantId);e&&(t+=i.quantity,r+=i.quantity*e.price,n=e.currency)}return{itemCount:t,subtotal:r,currency:n}}function i(e,t){let r=new Map;for(let e of t)for(let t of e.variants)r.set(t.id,{product:e,variant:t});return e.flatMap(e=>{let t=r.get(e.variantId);return t?[{item:e,product:t.product,variant:t.variant}]:[]})}},6662:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(6586),n=r(7826);let i=n.memo(function(e){let{variant:t="primary",className:r,...i}=e,o=(0,n.useMemo)(()=>["inline-flex","min-h-12","items-center","justify-center","rounded-full","px-5","text-sm","font-semibold","tracking-wide","transition","focus-visible:focus-ring","disabled:cursor-not-allowed","disabled:opacity-60",...{primary:["bg-primary","text-primary-foreground","hover:bg-accent"],outline:["border","border-border-1","text-foreground","hover:border-primary/70","hover:text-accent"],ghost:["text-foreground","hover:text-accent"]}[t],r].filter(Boolean).join(" "),[r,t]);return(0,a.jsx)("button",{...i,className:o})})},7157:(e,t,r)=>{"use strict";r.d(t,{P5:()=>l,_s:()=>s,e:()=>u,jo:()=>f,n5:()=>c,uP:()=>d});let a={sand:{label:"Sand",hex:"hsl(var(--color-sand))"},ocean:{label:"Ocean",hex:"hsl(var(--color-ocean))"},berry:{label:"Berry",hex:"hsl(var(--color-berry))"}},n=["kids","adult"],i=["sand","ocean","berry"],o={classic:{kids:3400,adult:3800},sport:{kids:3600,adult:4e3}};function s(e){let[t,r,s]=e.split("-");if(!t||!r||!s||!n.includes(r)||!i.includes(s))return;let l=o[t];if(!l)return;let c=a[s];return{id:e,size:r,color:s,colorLabel:c.label,colorHex:c.hex,price:l[r],currency:"USD",stripePriceId:"price_".concat(t,"_").concat(r,"_").concat(s),inStock:!0}}function l(e,t,r){return e.variants.find(e=>e.size===t&&e.color===r)}function c(e){var t;let r=e.variants[0];if(!r)throw Error("Product has no variants");return null!=(t=e.variants.find(e=>e.inStock))?t:r}function u(e){let t=new Set;for(let r of e.variants)t.add(r.size);return n.filter(e=>t.has(e))}function d(e){let t=new Set;for(let r of e.variants)t.add(r.color);return i.filter(e=>t.has(e))}function f(e){var t,r;return null!=(r=null==(t=a[e])?void 0:t.hex)?r:"hsl(var(--color-fg))"}},7363:(e,t,r)=>{Promise.resolve().then(r.bind(r,4625))},7718:(e,t,r)=>{"use strict";r.d(t,{_x:()=>n,pE:()=>i,yY:()=>a});let a=1,n=10;function i(e){return Number.isNaN(e)||e<a?a:e>n?n:Math.floor(e)}}},e=>{var t=t=>e(e.s=t);e.O(0,[106,132,956,889,358],()=>t(7363)),_N_E=e.O()}]);