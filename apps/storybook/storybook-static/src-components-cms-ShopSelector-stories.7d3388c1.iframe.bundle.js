"use strict";(self.webpackChunk_apps_storybook=self.webpackChunk_apps_storybook||[]).push([[8910],{"../../__mocks__/next/navigation.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__,notFound:()=>notFound,permanentRedirect:()=>permanentRedirect,redirect:()=>redirect,revalidatePath:()=>revalidatePath,revalidateTag:()=>revalidateTag,useParams:()=>useParams,usePathname:()=>usePathname,useRouter:()=>useRouter,useSearchParams:()=>useSearchParams});var storybook_test__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("storybook/test"),process=__webpack_require__("../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js"),console=__webpack_require__("../../node_modules/.pnpm/console-browserify@1.2.0/node_modules/console-browserify/index.js");function logWarning(message,details){(function isDev(){var _process_env;return void 0===process||"production"!==(null===(_process_env=process.env)||void 0===_process_env?void 0:"production")})()&&(details?console.warn(message,details):console.warn(message))}function getWindow(){return window}const router={push:(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)().mockName("next/navigation.router.push"),replace:(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)().mockName("next/navigation.router.replace"),prefetch:(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)(async()=>{}).mockName("next/navigation.router.prefetch"),back:(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)().mockName("next/navigation.router.back"),forward:(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)().mockName("next/navigation.router.forward"),refresh:(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)().mockName("next/navigation.router.refresh")},useRouter=(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)(()=>router).mockName("next/navigation.useRouter"),usePathname=(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)(()=>function currentPathname(){try{var _win_location;const win=getWindow();var _win_location_pathname;return null!==(_win_location_pathname=null==win||null===(_win_location=win.location)||void 0===_win_location?void 0:_win_location.pathname)&&void 0!==_win_location_pathname?_win_location_pathname:"/"}catch(error){return logWarning("[storybook mock] Failed to read window.location.pathname",error),"/"}}()).mockName("next/navigation.usePathname"),useSearchParams=(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)(()=>{const params=new URLSearchParams(function currentSearch(){try{var _win_location;const win=getWindow();var _win_location_search;return null!==(_win_location_search=null==win||null===(_win_location=win.location)||void 0===_win_location?void 0:_win_location.search)&&void 0!==_win_location_search?_win_location_search:""}catch(error){return logWarning("[storybook mock] Failed to read window.location.search",error),""}}());return{get:key=>params.get(key),getAll:key=>params.getAll(key),has:key=>params.has(key),entries:()=>params.entries(),keys:()=>params.keys(),values:()=>params.values(),toString:()=>params.toString(),forEach:(callback,thisArg)=>params.forEach(callback,thisArg),size:params.size,[Symbol.iterator]:()=>params[Symbol.iterator]()}}).mockName("next/navigation.useSearchParams"),useParams=(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)(()=>({})).mockName("next/navigation.useParams"),redirect=(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)((url,status)=>{logWarning("[storybook mock] next/navigation.redirect called",{url,status})}).mockName("next/navigation.redirect"),notFound=(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)(()=>{logWarning("[storybook mock] next/navigation.notFound called")}).mockName("next/navigation.notFound"),revalidatePath=(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)(()=>{logWarning("[storybook mock] next/navigation.revalidatePath called")}).mockName("next/navigation.revalidatePath"),revalidateTag=(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)(()=>{logWarning("[storybook mock] next/navigation.revalidateTag called")}).mockName("next/navigation.revalidateTag"),permanentRedirect=(0,storybook_test__WEBPACK_IMPORTED_MODULE_0__.fn)((url,status)=>{logWarning("[storybook mock] next/navigation.permanentRedirect called",{url,status})}).mockName("next/navigation.permanentRedirect"),__WEBPACK_DEFAULT_EXPORT__={useRouter,usePathname,useSearchParams,useParams,redirect,notFound,revalidatePath,revalidateTag,permanentRedirect}},"../../packages/shared-utils/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{x6:()=>fetchJson,vv:()=>formatCurrency,$g:()=>formatPrice,Qm:()=>getCsrfToken,e6:()=>getShopFromPath,hJ:()=>replaceShopInPath,g6:()=>toggleItem});var types=__webpack_require__("../../node_modules/.pnpm/zod@3.25.73/node_modules/zod/v3/types.js");async function fetchJson(input,init,schema){const res=await fetch(input,init);if(res.ok){let data;try{const resWithJson=res;if("function"==typeof resWithJson.json)data=await resWithJson.json();else{const text=await res.text();data=text?JSON.parse(text):void 0}}catch(e){data=void 0}return schema?schema.parse(data):data}const text=await res.text().catch(()=>"");let message,parsed,isJson=!1;try{parsed=text?JSON.parse(text):void 0,isJson=!0}catch(e){parsed=void 0}const error=types.Ik({error:types.Yj()}).safeParse(parsed);throw message=error.success?error.data.error:res.statusText?res.statusText:!isJson&&text?text:`HTTP ${res.status}`,new Error(message)}__webpack_require__("../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js");function toggleItem(list,value){return list.includes(value)?list.filter(v=>v!==value):[...list,value]}function getCsrfToken(req){var _document_querySelector_getAttribute,_document_querySelector,_document_cookie_split_map_find_split_,_document_cookie_split_map_find,_document_querySelector_getAttribute_trim;if(req){var _getHeader,_cookieHeader_split_map_find_,_cookieHeader_split_map_find;const headers=req.headers,getHeader="function"==typeof(null==headers?void 0:headers.get)?name=>{var _headers_get;return null!==(_headers_get=headers.get(name))&&void 0!==_headers_get?_headers_get:void 0}:name=>null==headers?void 0:headers[name],headerToken=null===(_getHeader=getHeader("x-csrf-token"))||void 0===_getHeader?void 0:_getHeader.trim();if(headerToken)return headerToken;const reqUrl=req.url;if(reqUrl){var _searchParams_get;const queryToken=null===(_searchParams_get=new URL(reqUrl,"http://dummy").searchParams.get("csrf_token"))||void 0===_searchParams_get?void 0:_searchParams_get.trim();if(queryToken)return queryToken}var _getHeader1;return(null===(_cookieHeader_split_map_find=(null!==(_getHeader1=getHeader("cookie"))&&void 0!==_getHeader1?_getHeader1:"").split(";").map(row=>row.trim().split("=")).find(([name,value])=>["csrf_token","csrf"].includes(name)&&(null==value?void 0:value.trim())&&!value.trim().startsWith("/")))||void 0===_cookieHeader_split_map_find||null===(_cookieHeader_split_map_find_=_cookieHeader_split_map_find[1])||void 0===_cookieHeader_split_map_find_?void 0:_cookieHeader_split_map_find_.trim())||void 0}if("undefined"==typeof document)return;let csrfToken=null!==(_document_querySelector_getAttribute_trim=null===(_document_querySelector=document.querySelector('meta[name="csrf-token"]'))||void 0===_document_querySelector||null===(_document_querySelector_getAttribute=_document_querySelector.getAttribute("content"))||void 0===_document_querySelector_getAttribute?void 0:_document_querySelector_getAttribute.trim())&&void 0!==_document_querySelector_getAttribute_trim?_document_querySelector_getAttribute_trim:null===(_document_cookie_split_map_find=document.cookie.split(";").map(row=>row.trim()).find(row=>row.startsWith("csrf_token=")))||void 0===_document_cookie_split_map_find||null===(_document_cookie_split_map_find_split_=_document_cookie_split_map_find.split("=")[1])||void 0===_document_cookie_split_map_find_split_?void 0:_document_cookie_split_map_find_split_.trim();return csrfToken||(csrfToken=crypto.randomUUID(),document.cookie=`csrf_token=${csrfToken}; path=/; SameSite=Strict${"https:"===location.protocol?"; secure":""}`),csrfToken}__webpack_require__("../../node_modules/.pnpm/next@15.3.5_@babel+core@7.28.4_@opentelemetry+api@1.9.0_@playwright+test@1.53.2_babel-p_5f4009eaaa2f46513e879f269f75344a/node_modules/next/server.js");function formatCurrency(amount,currency="USD",locale){var _Intl_supportedValuesOf,_Intl;if(!/^[A-Z]{3}$/.test(currency))throw new RangeError(`Invalid currency code: ${currency}`);const supported=null===(_Intl_supportedValuesOf=(_Intl=Intl).supportedValuesOf)||void 0===_Intl_supportedValuesOf?void 0:_Intl_supportedValuesOf.call(_Intl,"currency");if(supported&&!supported.includes(currency))throw new RangeError(`Invalid currency code: ${currency}`);const value=null!=amount?amount:NaN;return new Intl.NumberFormat(locale,{style:"currency",currency}).format(value/100)}function formatPrice(amount,currency="USD",locale){if("function"==typeof Intl.supportedValuesOf){if(!Intl.supportedValuesOf("currency").includes(currency))throw new RangeError(`Unsupported currency code: ${currency}`)}const normalizedAmount=null==amount?NaN:amount;return new Intl.NumberFormat(locale,{style:"currency",currency}).format(normalizedAmount)}var _process_env_LOG_LEVEL,browser=__webpack_require__("../../node_modules/.pnpm/pino@9.9.0/node_modules/pino/browser.js"),browser_default=__webpack_require__.n(browser);const level=null!==(_process_env_LOG_LEVEL=__webpack_require__("../../node_modules/.pnpm/process@0.11.10/node_modules/process/browser.js").env.LOG_LEVEL)&&void 0!==_process_env_LOG_LEVEL?_process_env_LOG_LEVEL:"info";browser_default()({level});function getShopFromPath(pathname){if(!pathname)return;try{const url=new URL(pathname,"http://dummy"),slug=url.searchParams.get("shop");if(slug)return slug;pathname=url.pathname}catch(e){}const segments=pathname.split("/").filter(Boolean);let idx=segments.indexOf("shop");return idx>=0?segments[idx+1]:(idx=segments.indexOf("shops"),idx>=0?segments[idx+1]:void 0)}function replaceShopInPath(pathname,shop){if(!pathname)return`/cms/shop/${shop}`;const hasTrailingSlash=pathname.endsWith("/"),[path,q]=pathname.split("?");let query=q,trailingSlash=path.endsWith("/");hasTrailingSlash&&!trailingSlash&&(trailingSlash=!0,query&&(query=query.replace(/\/$/,"")));const segments=path.split("/").filter(Boolean),idxShop=segments.indexOf("shop"),idxShops=segments.indexOf("shops");if(idxShop>=0){idxShop+1<segments.length?segments[idxShop+1]=shop:segments.push(shop);let newPath="/"+segments.join("/");return trailingSlash&&(newPath+="/"),query?`${newPath}?${query}`:newPath}if(idxShops>=0){idxShops+1<segments.length?segments[idxShops+1]=shop:segments.push(shop);let newPath="/"+segments.join("/");return trailingSlash&&(newPath+="/"),query?`${newPath}?${query}`:newPath}if("cms"===segments[0]){let base=`/cms/shop/${shop}`;return trailingSlash&&(base+="/"),query?`${base}?${query}`:base}return pathname}__webpack_require__("../../node_modules/.pnpm/buffer@6.0.3/node_modules/buffer/index.js").hp},"../../packages/ui/src/components/cms/ShopSelector.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,ErrorState:()=>ErrorState,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var msw__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/.pnpm/msw@2.11.3_@types+node@20.19.4_typescript@5.8.3/node_modules/msw/lib/core/http.mjs"),msw__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/.pnpm/msw@2.11.3_@types+node@20.19.4_typescript@5.8.3/node_modules/msw/lib/core/delay.mjs"),msw__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/.pnpm/msw@2.11.3_@types+node@20.19.4_typescript@5.8.3/node_modules/msw/lib/core/HttpResponse.mjs"),_ShopSelector__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../packages/ui/src/components/cms/ShopSelector.tsx");const baseShops=["acme-boutique","luxury-lab","flagship-eu"],__WEBPACK_DEFAULT_EXPORT__={title:"CMS/ShopSelector",component:_ShopSelector__WEBPACK_IMPORTED_MODULE_0__.A,tags:["autodocs"],parameters:{msw:{handlers:[msw__WEBPACK_IMPORTED_MODULE_1__.L.get("/api/shops",async()=>(await(0,msw__WEBPACK_IMPORTED_MODULE_2__.cb)(120),msw__WEBPACK_IMPORTED_MODULE_3__.c.json(baseShops,{status:200})))]}}},Default={},ErrorState={parameters:{msw:{handlers:[msw__WEBPACK_IMPORTED_MODULE_1__.L.get("/api/shops",async()=>(await(0,msw__WEBPACK_IMPORTED_MODULE_2__.cb)(120),msw__WEBPACK_IMPORTED_MODULE_3__.c.json({error:"mock-error"},{status:500})))]}}},__namedExportsOrder=["Default","ErrorState"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{}",...Default.parameters?.docs?.source}}},ErrorState.parameters={...ErrorState.parameters,docs:{...ErrorState.parameters?.docs,source:{originalSource:'{\n  parameters: {\n    msw: {\n      handlers: [http.get("/api/shops", async () => {\n        await delay(120);\n        return HttpResponse.json({\n          error: "mock-error"\n        }, {\n          status: 500\n        });\n      })]\n    }\n  }\n}',...ErrorState.parameters?.docs?.source}}}},"../../packages/ui/src/components/cms/ShopSelector.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>ShopSelector});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/.pnpm/next@15.3.5_@babel+core@7.28.4_@opentelemetry+api@1.9.0_@playwright+test@1.53.2_babel-p_5f4009eaaa2f46513e879f269f75344a/node_modules/next/dist/compiled/react/jsx-runtime.js"),_acme_shared_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/shared-utils/src/index.ts"),next_navigation__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../__mocks__/next/navigation.js"),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/.pnpm/next@15.3.5_@babel+core@7.28.4_@opentelemetry+api@1.9.0_@playwright+test@1.53.2_babel-p_5f4009eaaa2f46513e879f269f75344a/node_modules/next/dist/compiled/react/index.js"),_atoms_shadcn__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../packages/ui/src/components/atoms/shadcn/index.ts"),_acme_i18n__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../packages/i18n/src/index.ts"),console=__webpack_require__("../../node_modules/.pnpm/console-browserify@1.2.0/node_modules/console-browserify/index.js");function ShopSelector(){const t=(0,_acme_i18n__WEBPACK_IMPORTED_MODULE_5__.c3)(),[shops,setShops]=(0,react__WEBPACK_IMPORTED_MODULE_3__.useState)([]),[status,setStatus]=(0,react__WEBPACK_IMPORTED_MODULE_3__.useState)("loading"),[errorMsg,setErrorMsg]=(0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null);var _usePathname;const pathname=null!==(_usePathname=(0,next_navigation__WEBPACK_IMPORTED_MODULE_2__.usePathname)())&&void 0!==_usePathname?_usePathname:"",router=(0,next_navigation__WEBPACK_IMPORTED_MODULE_2__.useRouter)();(0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{!async function fetchShops(){try{const res=await fetch("/api/shops");if(res.ok){const data=await res.json();if(Array.isArray(data))return setShops(data),void setStatus("ready");setErrorMsg("Invalid response")}else{const json=await res.json().catch(()=>({}));var _json_error;setErrorMsg(null!==(_json_error=json.error)&&void 0!==_json_error?_json_error:`Error ${res.status}`)}setStatus("error")}catch(err){console.error("Error loading shops",err),setErrorMsg(err instanceof Error?err.message:"Failed to load shops"),setStatus("error"),setShops([])}}()},[]);const selected=(0,_acme_shared_utils__WEBPACK_IMPORTED_MODULE_1__.e6)(pathname);return"loading"===status?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"text-sm",children:t("cms.shops.loading")}):"error"===status?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"text-sm text-danger","data-token":"--color-danger",children:null!=errorMsg?errorMsg:t("cms.shops.loadFailed")}):0===shops.length?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"text-muted-foreground text-sm",children:t("cms.shops.empty")}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_4__.l6,{value:null!=selected?selected:"",onValueChange:v=>function changeShop(value){const search=window.location.search,newPath=(0,_acme_shared_utils__WEBPACK_IMPORTED_MODULE_1__.hJ)(pathname,value);router.push(`${newPath}${search}`)}(v),"data-cy":"shop-select",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_4__.bq,{"data-cy":"shop-select","aria-label":String(t("cms.shops.ariaLabel")),className:"w-36",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_4__.yv,{placeholder:String(t("cms.shops.selectPlaceholder"))})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_4__.gC,{children:shops.map(s=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_atoms_shadcn__WEBPACK_IMPORTED_MODULE_4__.eb,{value:s,children:s},s))})]})}ShopSelector.__docgenInfo={description:"",methods:[],displayName:"ShopSelector"}}}]);