name = "telemetry-worker"
main = "src/index.ts"
compatibility_date = "2025-12-26"

[vars]
# Comma-separated list of allowed origins for CORS
TELEMETRY_ALLOWED_ORIGINS = "https://cms.example.com,http://localhost:3006"

# Days to retain telemetry data (default: 90)
RETENTION_DAYS = "90"

# Optional: require auth token for POST
# TELEMETRY_AUTH_TOKEN = ""

[[d1_databases]]
binding = "DB"
database_name = "telemetry"
database_id = "" # Created via: wrangler d1 create telemetry

# Scheduled cleanup (daily at 3am UTC)
[triggers]
crons = ["0 3 * * *"]
