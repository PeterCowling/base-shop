// tsconfig.test.json   ← root repo “unit-test” TypeScript config
{
  "extends": "./tsconfig.base.json",

  /* ────────────────────────────────────────────────────────────────────
   *  Compiler options tuned for running Jest + ts-jest in JSDOM
   * ────────────────────────────────────────────────────────────────── */
  "compilerOptions": {
    /* execution environment ----------------------------------------- */
    "jsx": "react-jsx",
    "types": ["node", "jest", "@testing-library/jest-dom"],

    /* allow plain-JS helpers used only during test-runs ------------- */
    "allowJs": true,
    "resolveJsonModule": true,

    /* test-specific flags ------------------------------------------- */
    // Normalize TS program root so ts-jest can always compute emit paths
    // even when tests are invoked from the repo root targeting package files.
    "rootDir": ".",
    // ts-jest requires a concrete outDir when emitting transformed files.
    // Use a scratch dir so running tests from the repo root or a package
    // always has a valid compiler output location.
    "noEmit": false,
    "importsNotUsedAsValues": "remove",
    "verbatimModuleSyntax": false,
    "outDir": ".ts-jest"
  },

  /* ────────────────────────────────────────────────────────────────────
   *  Which files constitute the *unit-test* compilation boundary
   * ────────────────────────────────────────────────────────────────── */
  "include": [
    "jest.setup.ts",
    "test/**/*.ts",
    "test/**/*.tsx",
    "test/**/*.js",
    // Allow running tests from IDEs or root by including
    // workspace package/app test files directly.
    "packages/**/__tests__/**/*.ts",
    "packages/**/__tests__/**/*.tsx",
    "packages/**/?(*.)+(spec|test).ts",
    "packages/**/?(*.)+(spec|test).tsx",
    "apps/**/__tests__/**/*.ts",
    "apps/**/__tests__/**/*.tsx",
    "apps/**/?(*.)+(spec|test).ts",
    "apps/**/?(*.)+(spec|test).tsx"
  ],

  /* Exclude e2e specs and any test-framework configs of their own ---- */
  "exclude": ["test/e2e/**"],

  /* Workspace packages that carry their own unit-test configs -------- */
  "references": [
    { "path": "./packages/auth/tsconfig.test.json" },
    { "path": "./packages/config/tsconfig.test.json" },
    { "path": "./packages/configurator/tsconfig.test.json" },
    { "path": "./packages/date-utils/tsconfig.test.json" },
    { "path": "./packages/design-tokens/tsconfig.test.json" },
    { "path": "./packages/email-templates/tsconfig.test.json" },
    { "path": "./packages/lib/tsconfig.test.json" },
    { "path": "./packages/platform-core/tsconfig.test.json" },
    { "path": "./packages/platform-machine/tsconfig.test.json" },
    { "path": "./packages/tailwind-config/tsconfig.test.json" },
    { "path": "./packages/template-app/tsconfig.test.json" },
    { "path": "./packages/themes/base/tsconfig.test.json" },
    { "path": "./packages/themes/bcd/tsconfig.test.json" },
    { "path": "./packages/themes/brandx/tsconfig.test.json" },
    { "path": "./packages/themes/dark/tsconfig.test.json" },
    { "path": "./packages/types/tsconfig.test.json" },
    { "path": "./packages/ui/tsconfig.test.json" },
    { "path": "./packages/i18n/tsconfig.test.json" },
      { "path": "./packages/email/tsconfig.test.json" },
      { "path": "./packages/eslint-plugin-ds/tsconfig.test.json" },
      { "path": "./packages/next-config/tsconfig.test.json" },
      { "path": "./packages/plugins/paypal/tsconfig.test.json" },
      { "path": "./packages/plugins/premier-shipping/tsconfig.test.json" },
      { "path": "./packages/plugins/sanity/tsconfig.test.json" },
      { "path": "./packages/sanity/tsconfig.test.json" },
      { "path": "./packages/stripe/tsconfig.test.json" },
      { "path": "./packages/telemetry/tsconfig.test.json" },
      { "path": "./packages/theme/tsconfig.test.json" },
      { "path": "./packages/zod-utils/tsconfig.test.json" },
    { "path": "./apps/cms/tsconfig.test.json" },
    { "path": "./apps/dashboard/tsconfig.test.json" },
    { "path": "./apps/shop-bcd/tsconfig.test.json" }
  ]
}
